(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))g(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&g(s)}).observe(document,{childList:!0,subtree:!0});function c(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function g(e){if(e.ep)return;e.ep=!0;const r=c(e);fetch(e.href,r)}})();const We=!1;var Be=Array.isArray,er=Array.prototype.indexOf,Ge=Array.from,gn=Object.defineProperty,Ft=Object.getOwnPropertyDescriptor,nr=Object.getOwnPropertyDescriptors,rr=Object.prototype,ir=Array.prototype,bn=Object.getPrototypeOf,ze=Object.isExtensible;const Bt=()=>{};function or(n){return n()}function Te(n){for(var t=0;t<n.length;t++)n[t]()}const lt=2,mn=4,pe=8,Ie=16,dt=32,Pt=64,re=128,ut=256,ie=512,nt=1024,yt=2048,Et=4096,vt=8192,he=16384,ur=32768,Me=65536,ar=1<<19,kn=1<<20,je=1<<21,Gt=Symbol("$state");function xn(n){return n===this.v}function Sn(n,t){return n!=n?t==t:n!==t||n!==null&&typeof n=="object"||typeof n=="function"}function An(n){return!Sn(n,this.v)}function fr(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function sr(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function lr(n){throw new Error("https://svelte.dev/e/effect_orphan")}function cr(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function pr(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function hr(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function vr(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Wt=!1,dr=!1;function yr(){Wt=!0}const wr=1,_r=2,gr=16,br=1,mr=2,tt=Symbol();function Tn(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let W=null;function Ve(n){W=n}function ve(n,t=!1,c){var g=W={p:W,c:null,d:!1,e:null,m:!1,s:n,x:null,l:null};Wt&&!t&&(W.l={s:null,u:null,r1:[],r2:Kt(!1)}),Ue(()=>{g.d=!0})}function de(n){const t=W;if(t!==null){const s=t.e;if(s!==null){var c=K,g=q;t.e=null;try{for(var e=0;e<s.length;e++){var r=s[e];kt(r.effect),ct(r.reaction),Re(r.fn)}}finally{kt(c),ct(g)}}W=t.p,t.m=!0}return{}}function zt(){return!Wt||W!==null&&W.l===null}function Ct(n,t){if(typeof n!="object"||n===null||Gt in n)return n;const c=bn(n);if(c!==rr&&c!==ir)return n;var g=new Map,e=Be(n),r=wt(0),s=q,d=p=>{var u=q;ct(s);var a;return a=p(),ct(u),a};return e&&g.set("length",wt(n.length)),new Proxy(n,{defineProperty(p,u,a){(!("value"in a)||a.configurable===!1||a.enumerable===!1||a.writable===!1)&&pr();var f=g.get(u);return f===void 0?(f=d(()=>wt(a.value)),g.set(u,f)):F(f,d(()=>Ct(a.value))),!0},deleteProperty(p,u){var a=g.get(u);if(a===void 0)u in p&&g.set(u,d(()=>wt(tt)));else{if(e&&typeof u=="string"){var f=g.get("length"),v=Number(u);Number.isInteger(v)&&v<f.v&&F(f,v)}F(a,tt),Xe(r)}return!0},get(p,u,a){var o;if(u===Gt)return n;var f=g.get(u),v=u in p;if(f===void 0&&(!v||(o=Ft(p,u))!=null&&o.writable)&&(f=d(()=>wt(Ct(v?p[u]:tt))),g.set(u,f)),f!==void 0){var k=M(f);return k===tt?void 0:k}return Reflect.get(p,u,a)},getOwnPropertyDescriptor(p,u){var a=Reflect.getOwnPropertyDescriptor(p,u);if(a&&"value"in a){var f=g.get(u);f&&(a.value=M(f))}else if(a===void 0){var v=g.get(u),k=v==null?void 0:v.v;if(v!==void 0&&k!==tt)return{enumerable:!0,configurable:!0,value:k,writable:!0}}return a},has(p,u){var k;if(u===Gt)return!0;var a=g.get(u),f=a!==void 0&&a.v!==tt||Reflect.has(p,u);if(a!==void 0||K!==null&&(!f||(k=Ft(p,u))!=null&&k.writable)){a===void 0&&(a=d(()=>wt(f?Ct(p[u]):tt)),g.set(u,a));var v=M(a);if(v===tt)return!1}return f},set(p,u,a,f){var i;var v=g.get(u),k=u in p;if(e&&u==="length")for(var o=a;o<v.v;o+=1){var b=g.get(o+"");b!==void 0?F(b,tt):o in p&&(b=d(()=>wt(tt)),g.set(o+"",b))}v===void 0?(!k||(i=Ft(p,u))!=null&&i.writable)&&(v=d(()=>wt(void 0)),F(v,d(()=>Ct(a))),g.set(u,v)):(k=v.v!==tt,F(v,d(()=>Ct(a))));var _=Reflect.getOwnPropertyDescriptor(p,u);if(_!=null&&_.set&&_.set.call(f,a),!k){if(e&&typeof u=="string"){var m=g.get("length"),l=Number(u);Number.isInteger(l)&&l>=m.v&&F(m,l+1)}Xe(r)}return!0},ownKeys(p){M(r);var u=Reflect.ownKeys(p).filter(v=>{var k=g.get(v);return k===void 0||k.v!==tt});for(var[a,f]of g)f.v!==tt&&!(a in p)&&u.push(a);return u},setPrototypeOf(){hr()}})}function Xe(n,t=1){F(n,n.v+t)}const Jt=new Map;function Kt(n,t){var c={f:0,v:n,reactions:null,equals:xn,rv:0,wv:0};return c}function wt(n,t){const c=Kt(n);return Gr(c),c}function et(n,t=!1){var g;const c=Kt(n);return t||(c.equals=An),Wt&&W!==null&&W.l!==null&&((g=W.l).s??(g.s=[])).push(c),c}function F(n,t,c=!1){q!==null&&!st&&zt()&&(q.f&(lt|Ie))!==0&&!(Q!=null&&Q.includes(n))&&vr();let g=c?Ct(t):t;return jn(n,g)}function jn(n,t){if(!n.equals(t)){var c=n.v;Xt?Jt.set(n,t):Jt.set(n,c),n.v=t,n.wv=qn(),En(n,yt),zt()&&K!==null&&(K.f&nt)!==0&&(K.f&(dt|Pt))===0&&(ot===null?Ir([n]):ot.push(n))}return t}function En(n,t){var c=n.reactions;if(c!==null)for(var g=zt(),e=c.length,r=0;r<e;r++){var s=c[r],d=s.f;(d&yt)===0&&(!g&&s===K||(at(s,t),(d&(nt|ut))!==0&&((d&lt)!==0?En(s,Et):ge(s))))}}let kr=!1;var Ye,On,Dn,$n;function xr(){if(Ye===void 0){Ye=window,On=/Firefox/.test(navigator.userAgent);var n=Element.prototype,t=Node.prototype,c=Text.prototype;Dn=Ft(t,"firstChild").get,$n=Ft(t,"nextSibling").get,ze(n)&&(n.__click=void 0,n.__className=void 0,n.__attributes=null,n.__style=void 0,n.__e=void 0),ze(c)&&(c.__t=void 0)}}function Sr(n=""){return document.createTextNode(n)}function oe(n){return Dn.call(n)}function ye(n){return $n.call(n)}function z(n,t){return oe(n)}function Nn(n,t){{var c=oe(n);return c instanceof Comment&&c.data===""?ye(c):c}}function Y(n,t=1,c=!1){let g=n;for(;t--;)g=ye(g);return g}function Ar(n){n.textContent=""}function Pe(n){var t=lt|yt,c=q!==null&&(q.f&lt)!==0?q:null;return K===null||c!==null&&(c.f&ut)!==0?t|=ut:K.f|=kn,{ctx:W,deps:null,effects:null,equals:xn,f:t,fn:n,reactions:null,rv:0,v:null,wv:0,parent:c??K}}function Ee(n){const t=Pe(n);return t.equals=An,t}function Cn(n){var t=n.effects;if(t!==null){n.effects=null;for(var c=0;c<t.length;c+=1)mt(t[c])}}function Tr(n){for(var t=n.parent;t!==null;){if((t.f&lt)===0)return t;t=t.parent}return null}function jr(n){var t,c=K;kt(Tr(n));try{Cn(n),t=Kn(n)}finally{kt(c)}return t}function Bn(n){var t=jr(n),c=(gt||(n.f&ut)!==0)&&n.deps!==null?Et:nt;at(n,c),n.equals(t)||(n.v=t,n.wv=qn())}function Gn(n){K===null&&q===null&&lr(),q!==null&&(q.f&ut)!==0&&K===null&&sr(),Xt&&fr()}function Er(n,t){var c=t.last;c===null?t.last=t.first=n:(c.next=n,n.prev=c,t.last=n)}function Ut(n,t,c,g=!0){var e=K,r={ctx:W,deps:null,nodes_start:null,nodes_end:null,f:n|yt,first:null,fn:t,last:null,next:null,parent:e,prev:null,teardown:null,transitions:null,wv:0};if(c)try{_e(r),r.f|=ur}catch(p){throw mt(r),p}else t!==null&&ge(r);var s=c&&r.deps===null&&r.first===null&&r.nodes_start===null&&r.teardown===null&&(r.f&(kn|re))===0;if(!s&&g&&(e!==null&&Er(r,e),q!==null&&(q.f&lt)!==0)){var d=q;(d.effects??(d.effects=[])).push(r)}return r}function Ue(n){const t=Ut(pe,null,!1);return at(t,nt),t.teardown=n,t}function Oe(n){Gn();var t=K!==null&&(K.f&dt)!==0&&W!==null&&!W.m;if(t){var c=W;(c.e??(c.e=[])).push({fn:n,effect:K,reaction:q})}else{var g=Re(n);return g}}function Or(n){return Gn(),Vt(n)}function Dr(n){const t=Ut(Pt,n,!0);return(c={})=>new Promise(g=>{c.outro?ue(t,()=>{mt(t),g(void 0)}):(mt(t),g(void 0))})}function Re(n){return Ut(mn,n,!1)}function Ze(n,t){var c=W,g={effect:null,ran:!1};c.l.r1.push(g),g.effect=Vt(()=>{n(),!g.ran&&(g.ran=!0,F(c.l.r2,!0),Ot(t))})}function $r(){var n=W;Vt(()=>{if(M(n.l.r2)){for(var t of n.l.r1){var c=t.effect;(c.f&nt)!==0&&at(c,Et),Rt(c)&&_e(c),t.ran=!1}n.l.r2.v=!1}})}function Vt(n){return Ut(pe,n,!0)}function It(n,t=[],c=Pe){const g=t.map(c);return Le(()=>n(...g.map(M)))}function Le(n,t=0){return Ut(pe|Ie|t,n,!0)}function Ht(n,t=!0){return Ut(pe|dt,n,!0,t)}function In(n){var t=n.teardown;if(t!==null){const c=Xt,g=q;Qe(!0),ct(null);try{t.call(null)}finally{Qe(c),ct(g)}}}function Mn(n,t=!1){var c=n.first;for(n.first=n.last=null;c!==null;){var g=c.next;(c.f&Pt)!==0?c.parent=null:mt(c,t),c=g}}function Nr(n){for(var t=n.first;t!==null;){var c=t.next;(t.f&dt)===0&&mt(t),t=c}}function mt(n,t=!0){var c=!1;if((t||(n.f&ar)!==0)&&n.nodes_start!==null){for(var g=n.nodes_start,e=n.nodes_end;g!==null;){var r=g===e?null:ye(g);g.remove(),g=r}c=!0}Mn(n,t&&!c),ce(n,0),at(n,he);var s=n.transitions;if(s!==null)for(const p of s)p.stop();In(n);var d=n.parent;d!==null&&d.first!==null&&Pn(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=null}function Pn(n){var t=n.parent,c=n.prev,g=n.next;c!==null&&(c.next=g),g!==null&&(g.prev=c),t!==null&&(t.first===n&&(t.first=g),t.last===n&&(t.last=c))}function ue(n,t){var c=[];Fe(n,c,!0),Un(c,()=>{mt(n),t&&t()})}function Un(n,t){var c=n.length;if(c>0){var g=()=>--c||t();for(var e of n)e.out(g)}else t()}function Fe(n,t,c){if((n.f&vt)===0){if(n.f^=vt,n.transitions!==null)for(const s of n.transitions)(s.is_global||c)&&t.push(s);for(var g=n.first;g!==null;){var e=g.next,r=(g.f&Me)!==0||(g.f&dt)!==0;Fe(g,t,r?c:!1),g=e}}}function ae(n){Rn(n,!0)}function Rn(n,t){if((n.f&vt)!==0){n.f^=vt,(n.f&nt)===0&&(n.f^=nt),Rt(n)&&(at(n,yt),ge(n));for(var c=n.first;c!==null;){var g=c.next,e=(c.f&Me)!==0||(c.f&dt)!==0;Rn(c,e?t:!1),c=g}if(n.transitions!==null)for(const r of n.transitions)(r.is_global||t)&&r.in()}}let fe=[];function Cr(){var n=fe;fe=[],Te(n)}function Ln(n){fe.length===0&&queueMicrotask(Cr),fe.push(n)}let Qt=!1,De=!1,se=null,jt=!1,Xt=!1;function Qe(n){Xt=n}let te=[];let q=null,st=!1;function ct(n){q=n}let K=null;function kt(n){K=n}let Q=null;function Br(n){Q=n}function Gr(n){q!==null&&q.f&je&&(Q===null?Br([n]):Q.push(n))}let Z=null,rt=0,ot=null;function Ir(n){ot=n}let Fn=1,le=0,gt=!1;function qn(){return++Fn}function Rt(n){var f;var t=n.f;if((t&yt)!==0)return!0;if((t&Et)!==0){var c=n.deps,g=(t&ut)!==0;if(c!==null){var e,r,s=(t&ie)!==0,d=g&&K!==null&&!gt,p=c.length;if(s||d){var u=n,a=u.parent;for(e=0;e<p;e++)r=c[e],(s||!((f=r==null?void 0:r.reactions)!=null&&f.includes(u)))&&(r.reactions??(r.reactions=[])).push(u);s&&(u.f^=ie),d&&a!==null&&(a.f&ut)===0&&(u.f^=ut)}for(e=0;e<p;e++)if(r=c[e],Rt(r)&&Bn(r),r.wv>n.wv)return!0}(!g||K!==null&&!gt)&&at(n,nt)}return!1}function Mr(n,t){for(var c=t;c!==null;){if((c.f&re)!==0)try{c.fn(n);return}catch{c.f^=re}c=c.parent}throw Qt=!1,n}function Pr(n){return(n.f&he)===0&&(n.parent===null||(n.parent.f&re)===0)}function we(n,t,c,g){if(Qt){if(c===null&&(Qt=!1),Pr(t))throw n;return}c!==null&&(Qt=!0);{Mr(n,t);return}}function Jn(n,t,c=!0){var g=n.reactions;if(g!==null)for(var e=0;e<g.length;e++){var r=g[e];Q!=null&&Q.includes(n)||((r.f&lt)!==0?Jn(r,t,!1):t===r&&(c?at(r,yt):(r.f&nt)!==0&&at(r,Et),ge(r)))}}function Kn(n){var k;var t=Z,c=rt,g=ot,e=q,r=gt,s=Q,d=W,p=st,u=n.f;Z=null,rt=0,ot=null,gt=(u&ut)!==0&&(st||!jt||q===null),q=(u&(dt|Pt))===0?n:null,Q=null,Ve(n.ctx),st=!1,le++,n.f|=je;try{var a=(0,n.fn)(),f=n.deps;if(Z!==null){var v;if(ce(n,rt),f!==null&&rt>0)for(f.length=rt+Z.length,v=0;v<Z.length;v++)f[rt+v]=Z[v];else n.deps=f=Z;if(!gt)for(v=rt;v<f.length;v++)((k=f[v]).reactions??(k.reactions=[])).push(n)}else f!==null&&rt<f.length&&(ce(n,rt),f.length=rt);if(zt()&&ot!==null&&!st&&f!==null&&(n.f&(lt|Et|yt))===0)for(v=0;v<ot.length;v++)Jn(ot[v],n);return e!==null&&(le++,ot!==null&&(g===null?g=ot:g.push(...ot))),a}finally{Z=t,rt=c,ot=g,q=e,gt=r,Q=s,Ve(d),st=p,n.f^=je}}function Ur(n,t){let c=t.reactions;if(c!==null){var g=er.call(c,n);if(g!==-1){var e=c.length-1;e===0?c=t.reactions=null:(c[g]=c[e],c.pop())}}c===null&&(t.f&lt)!==0&&(Z===null||!Z.includes(t))&&(at(t,Et),(t.f&(ut|ie))===0&&(t.f^=ie),Cn(t),ce(t,0))}function ce(n,t){var c=n.deps;if(c!==null)for(var g=t;g<c.length;g++)Ur(n,c[g])}function _e(n){var t=n.f;if((t&he)===0){at(n,nt);var c=K,g=W,e=jt;K=n,jt=!0;try{(t&Ie)!==0?Nr(n):Mn(n),In(n);var r=Kn(n);n.teardown=typeof r=="function"?r:null,n.wv=Fn;var s=n.deps,d;We&&dr&&n.f&yt}catch(p){we(p,n,c,g||n.ctx)}finally{jt=e,K=c}}}function Rr(){try{cr()}catch(n){if(se!==null)we(n,se,null);else throw n}}function Lr(){var n=jt;try{var t=0;for(jt=!0;te.length>0;){t++>1e3&&Rr();var c=te,g=c.length;te=[];for(var e=0;e<g;e++){var r=qr(c[e]);Fr(r)}}}finally{De=!1,jt=n,se=null,Jt.clear()}}function Fr(n){var t=n.length;if(t!==0)for(var c=0;c<t;c++){var g=n[c];if((g.f&(he|vt))===0)try{Rt(g)&&(_e(g),g.deps===null&&g.first===null&&g.nodes_start===null&&(g.teardown===null?Pn(g):g.fn=null))}catch(e){we(e,g,null,g.ctx)}}}function ge(n){De||(De=!0,queueMicrotask(Lr));for(var t=se=n;t.parent!==null;){t=t.parent;var c=t.f;if((c&(Pt|dt))!==0){if((c&nt)===0)return;t.f^=nt}}te.push(t)}function qr(n){for(var t=[],c=n;c!==null;){var g=c.f,e=(g&(dt|Pt))!==0,r=e&&(g&nt)!==0;if(!r&&(g&vt)===0){if((g&mn)!==0)t.push(c);else if(e)c.f^=nt;else{var s=q;try{q=c,Rt(c)&&_e(c)}catch(u){we(u,c,null,c.ctx)}finally{q=s}}var d=c.first;if(d!==null){c=d;continue}}var p=c.parent;for(c=c.next;c===null&&p!==null;)c=p.next,p=p.parent}return t}function M(n){var t=n.f,c=(t&lt)!==0;if(q!==null&&!st){if(!(Q!=null&&Q.includes(n))){var g=q.deps;n.rv<le&&(n.rv=le,Z===null&&g!==null&&g[rt]===n?rt++:Z===null?Z=[n]:(!gt||!Z.includes(n))&&Z.push(n))}}else if(c&&n.deps===null&&n.effects===null){var e=n,r=e.parent;r!==null&&(r.f&ut)===0&&(e.f^=ut)}return c&&(e=n,Rt(e)&&Bn(e)),Xt&&Jt.has(n)?Jt.get(n):n.v}function Ot(n){var t=st;try{return st=!0,n()}finally{st=t}}const Jr=-7169;function at(n,t){n.f=n.f&Jr|t}function Kr(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(Gt in n)$e(n);else if(!Array.isArray(n))for(let t in n){const c=n[t];typeof c=="object"&&c&&Gt in c&&$e(c)}}}function $e(n,t=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!t.has(n)){t.add(n),n instanceof Date&&n.getTime();for(let g in n)try{$e(n[g],t)}catch{}const c=bn(n);if(c!==Object.prototype&&c!==Array.prototype&&c!==Map.prototype&&c!==Set.prototype&&c!==Date.prototype){const g=nr(c);for(let e in g){const r=g[e].get;if(r)try{r.call(n)}catch{}}}}}const Hr=["touchstart","touchmove"];function Wr(n){return Hr.includes(n)}let tn=!1;function zr(){tn||(tn=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{var t;if(!n.defaultPrevented)for(const c of n.target.elements)(t=c.__on_r)==null||t.call(c)})},{capture:!0}))}function Hn(n){var t=q,c=K;ct(null),kt(null);try{return n()}finally{ct(t),kt(c)}}function Vr(n,t,c,g=c){n.addEventListener(t,()=>Hn(c));const e=n.__on_r;e?n.__on_r=()=>{e(),g(!0)}:n.__on_r=()=>g(!0),zr()}const Xr=new Set,en=new Set;function Yr(n,t,c,g={}){function e(r){if(g.capture||Lt.call(t,r),!r.cancelBubble)return Hn(()=>c==null?void 0:c.call(this,r))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?Ln(()=>{t.addEventListener(n,e,g)}):t.addEventListener(n,e,g),e}function St(n,t,c,g,e){var r={capture:g,passive:e},s=Yr(n,t,c,r);(t===document.body||t===window||t===document)&&Ue(()=>{t.removeEventListener(n,s,r)})}function Lt(n){var l;var t=this,c=t.ownerDocument,g=n.type,e=((l=n.composedPath)==null?void 0:l.call(n))||[],r=e[0]||n.target,s=0,d=n.__root;if(d){var p=e.indexOf(d);if(p!==-1&&(t===document||t===window)){n.__root=t;return}var u=e.indexOf(t);if(u===-1)return;p<=u&&(s=p)}if(r=e[s]||n.target,r!==t){gn(n,"currentTarget",{configurable:!0,get(){return r||c}});var a=q,f=K;ct(null),kt(null);try{for(var v,k=[];r!==null;){var o=r.assignedSlot||r.parentNode||r.host||null;try{var b=r["__"+g];if(b!=null&&(!r.disabled||n.target===r))if(Be(b)){var[_,...m]=b;_.apply(r,[n,...m])}else b.call(r,n)}catch(i){v?k.push(i):v=i}if(n.cancelBubble||o===t||o===null)break;r=o}if(v){for(let i of k)queueMicrotask(()=>{throw i});throw v}}finally{n.__root=t,delete n.currentTarget,ct(a),kt(f)}}}function Zr(n){var t=document.createElement("template");return t.innerHTML=n,t.content}function nn(n,t){var c=K;c.nodes_start===null&&(c.nodes_start=n,c.nodes_end=t)}function pt(n,t){var c=(t&br)!==0,g=(t&mr)!==0,e,r=!n.startsWith("<!>");return()=>{e===void 0&&(e=Zr(r?n:"<!>"+n),c||(e=oe(e)));var s=g||On?document.importNode(e,!0):e.cloneNode(!0);if(c){var d=oe(s),p=s.lastChild;nn(d,p)}else nn(s,s);return s}}function ft(n,t){n!==null&&n.before(t)}function bt(n,t){var c=t==null?"":typeof t=="object"?t+"":t;c!==(n.__t??(n.__t=n.nodeValue))&&(n.__t=c,n.nodeValue=c+"")}function Qr(n,t){return ti(n,t)}const $t=new Map;function ti(n,{target:t,anchor:c,props:g={},events:e,context:r,intro:s=!0}){xr();var d=new Set,p=f=>{for(var v=0;v<f.length;v++){var k=f[v];if(!d.has(k)){d.add(k);var o=Wr(k);t.addEventListener(k,Lt,{passive:o});var b=$t.get(k);b===void 0?(document.addEventListener(k,Lt,{passive:o}),$t.set(k,1)):$t.set(k,b+1)}}};p(Ge(Xr)),en.add(p);var u=void 0,a=Dr(()=>{var f=c??t.appendChild(Sr());return Ht(()=>{if(r){ve({});var v=W;v.c=r}e&&(g.$$events=e),u=n(f,g)||{},r&&de()}),()=>{var o;for(var v of d){t.removeEventListener(v,Lt);var k=$t.get(v);--k===0?(document.removeEventListener(v,Lt),$t.delete(v)):$t.set(v,k)}en.delete(p),f!==c&&((o=f.parentNode)==null||o.removeChild(f))}});return ei.set(u,a),u}let ei=new WeakMap;function At(n,t,[c,g]=[0,0]){var e=n,r=null,s=null,d=tt,p=c>0?Me:0,u=!1;const a=(v,k=!0)=>{u=!0,f(k,v)},f=(v,k)=>{d!==(d=v)&&(d?(r?ae(r):k&&(r=Ht(()=>k(e))),s&&ue(s,()=>{s=null})):(s?ae(s):k&&(s=Ht(()=>k(e,[c+1,g]))),r&&ue(r,()=>{r=null})))};Le(()=>{u=!1,t(a),u||f(null,null)},p)}function ni(n,t){return t}function ri(n,t,c,g){for(var e=[],r=t.length,s=0;s<r;s++)Fe(t[s].e,e,!0);var d=r>0&&e.length===0&&c!==null;if(d){var p=c.parentNode;Ar(p),p.append(c),g.clear(),_t(n,t[0].prev,t[r-1].next)}Un(e,()=>{for(var u=0;u<r;u++){var a=t[u];d||(g.delete(a.k),_t(n,a.prev,a.next)),mt(a.e,!d)}})}function ii(n,t,c,g,e,r=null){var s=n,d={flags:t,items:new Map,first:null},p=null,u=!1,a=Ee(()=>{var f=c();return Be(f)?f:f==null?[]:Ge(f)});Le(()=>{var f=M(a),v=f.length;u&&v===0||(u=v===0,oi(f,d,s,e,t,g,c),r!==null&&(v===0?p?ae(p):p=Ht(()=>r(s)):p!==null&&ue(p,()=>{p=null})),M(a))})}function oi(n,t,c,g,e,r,s){var d=n.length,p=t.items,u=t.first,a=u,f,v=null,k=[],o=[],b,_,m,l;for(l=0;l<d;l+=1){if(b=n[l],_=r(b,l),m=p.get(_),m===void 0){var i=a?a.e.nodes_start:c;v=ai(i,t,v,v===null?t.first:v.next,b,_,l,g,e,s),p.set(_,v),k=[],o=[],a=v.next;continue}if(ui(m,b,l),(m.e.f&vt)!==0&&ae(m.e),m!==a){if(f!==void 0&&f.has(m)){if(k.length<o.length){var y=o[0],w;v=y.prev;var A=k[0],S=k[k.length-1];for(w=0;w<k.length;w+=1)rn(k[w],y,c);for(w=0;w<o.length;w+=1)f.delete(o[w]);_t(t,A.prev,S.next),_t(t,v,A),_t(t,S,y),a=y,v=S,l-=1,k=[],o=[]}else f.delete(m),rn(m,a,c),_t(t,m.prev,m.next),_t(t,m,v===null?t.first:v.next),_t(t,v,m),v=m;continue}for(k=[],o=[];a!==null&&a.k!==_;)(a.e.f&vt)===0&&(f??(f=new Set)).add(a),o.push(a),a=a.next;if(a===null)continue;m=a}k.push(m),v=m,a=m.next}if(a!==null||f!==void 0){for(var j=f===void 0?[]:Ge(f);a!==null;)(a.e.f&vt)===0&&j.push(a),a=a.next;var O=j.length;if(O>0){var C=null;ri(t,j,C,p)}}K.first=t.first&&t.first.e,K.last=v&&v.e}function ui(n,t,c,g){jn(n.v,t),n.i=c}function ai(n,t,c,g,e,r,s,d,p,u){var a=(p&wr)!==0,f=(p&gr)===0,v=a?f?et(e):Kt(e):e,k=(p&_r)===0?s:Kt(s),o={i:k,v,k:r,a:null,e:null,prev:c,next:g};try{return o.e=Ht(()=>d(n,v,k,u),kr),o.e.prev=c&&c.e,o.e.next=g&&g.e,c===null?t.first=o:(c.next=o,c.e.next=o.e),g!==null&&(g.prev=o,g.e.prev=o.e),o}finally{}}function rn(n,t,c){for(var g=n.next?n.next.e.nodes_start:c,e=t?t.e.nodes_start:c,r=n.e.nodes_start;r!==g;){var s=ye(r);e.before(r),r=s}}function _t(n,t,c){t===null?n.first=c:(t.next=c,t.e.next=c&&c.e),c!==null&&(c.prev=t,c.e.prev=t&&t.e)}function fi(n,t,c){var g=n==null?"":""+n;return g=g?g+" "+t:t,g===""?null:g}function si(n,t,c,g,e,r){var s=n.__className;if(s!==c||s===void 0){var d=fi(c,g);d==null?n.removeAttribute("class"):n.className=d,n.__className=c}return r}function Ne(n,t,c=t){var g=zt();Vr(n,"input",e=>{var r=e?n.defaultValue:n.value;if(r=be(n)?me(r):r,c(r),g&&r!==(r=t())){var s=n.selectionStart,d=n.selectionEnd;n.value=r??"",d!==null&&(n.selectionStart=s,n.selectionEnd=Math.min(d,n.value.length))}}),Ot(t)==null&&n.value&&c(be(n)?me(n.value):n.value),Vt(()=>{var e=t();be(n)&&e===me(n.value)||n.type==="date"&&!e&&!n.value||e!==n.value&&(n.value=e??"")})}function be(n){var t=n.type;return t==="number"||t==="range"}function me(n){return n===""?null:+n}function on(n,t){return n===t||(n==null?void 0:n[Gt])===t}function li(n={},t,c,g){return Re(()=>{var e,r;return Vt(()=>{e=r,r=[],Ot(()=>{n!==c(...r)&&(t(n,...r),e&&on(c(...e),n)&&t(null,...e))})}),()=>{Ln(()=>{r&&on(c(...r),n)&&t(null,...r)})}}),n}function Wn(n){return function(...t){var c=t[0];return c.preventDefault(),n==null?void 0:n.apply(this,t)}}function qe(n=!1){const t=W,c=t.l.u;if(!c)return;let g=()=>Kr(t.s);if(n){let e=0,r={};const s=Pe(()=>{let d=!1;const p=t.s;for(const u in p)p[u]!==r[u]&&(r[u]=p[u],d=!0);return d&&e++,e});g=()=>M(s)}c.b.length&&Or(()=>{un(t,g),Te(c.b)}),Oe(()=>{const e=Ot(()=>c.m.map(or));return()=>{for(const r of e)typeof r=="function"&&r()}}),c.a.length&&Oe(()=>{un(t,g),Te(c.a)})}function un(n,t){if(n.l.s)for(const c of n.l.s)M(c);t()}function zn(n,t,c){if(n==null)return t(void 0),Bt;const g=Ot(()=>n.subscribe(t,c));return g.unsubscribe?()=>g.unsubscribe():g}const Nt=[];function Je(n,t=Bt){let c=null;const g=new Set;function e(d){if(Sn(n,d)&&(n=d,c)){const p=!Nt.length;for(const u of g)u[1](),Nt.push(u,n);if(p){for(let u=0;u<Nt.length;u+=2)Nt[u][0](Nt[u+1]);Nt.length=0}}}function r(d){e(d(n))}function s(d,p=Bt){const u=[d,p];return g.add(u),g.size===1&&(c=t(e,r)||Bt),d(n),()=>{g.delete(u),g.size===0&&c&&(c(),c=null)}}return{set:e,update:r,subscribe:s}}function ci(n){let t;return zn(n,c=>t=c)(),t}let Ce=Symbol();function Vn(n,t,c){const g=c[t]??(c[t]={store:null,source:et(void 0),unsubscribe:Bt});if(g.store!==n&&!(Ce in c))if(g.unsubscribe(),g.store=n??null,n==null)g.source.v=void 0,g.unsubscribe=Bt;else{var e=!0;g.unsubscribe=zn(n,r=>{e?g.source.v=r:F(g.source,r)}),e=!1}return n&&Ce in c?ci(n):M(g.source)}function Xn(){const n={};function t(){Ue(()=>{for(var c in n)n[c].unsubscribe();gn(n,Ce,{enumerable:!1,value:!0})})}return[n,t]}function Yn(n){W===null&&Tn(),Wt&&W.l!==null?hi(W).m.push(n):Oe(()=>{const t=Ot(n);if(typeof t=="function")return t})}function pi(n){W===null&&Tn(),Yn(()=>()=>Ot(n))}function hi(n){var t=n.l;return t.u??(t.u={a:[],b:[],m:[]})}const vi="5";var _n;typeof window<"u"&&((_n=window.__svelte??(window.__svelte={})).v??(_n.v=new Set)).add(vi);yr();var Tt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ke(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Zn(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ee={exports:{}};ee.exports;var an;function He(){return an||(an=1,function(n){(function(){function t(g,e){return e?Zn(g):g.slice?t[r(g)]:function(s,d){g(s={exports:{}}),t[r(d)]=s.exports};function r(s){return s.split("/").slice(-1).toString().replace(".js","")}}var c=n;t(function(g){String.random=function(r,s){var d="";for(r=r||24,s=s||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";r-- >0;)d+=s.charAt(Math.floor(Math.random()*s.length));return d},String.match=function(r,s){var d,p;return typeof r!="string"?!1:(typeof s=="string"&&(s={"=":s}),s=s||{},d=s["="]||s["*"]||s[">"]||s["<"],r===d?!0:p!==s["="]?!1:(d=s["*"]||s[">"],r.slice(0,(d||"").length)===d?!0:p!==s["*"]?!1:p!==s[">"]&&p!==s["<"]?r>=s[">"]&&r<=s["<"]:p!==s[">"]&&r>=s[">"]||p!==s["<"]&&r<=s["<"]))},String.hash=function(r,s){if(typeof r=="string"){if(s=s||0,!r.length)return s;for(var d=0,p=r.length,u;d<p;++d)u=r.charCodeAt(d),s=(s<<5)-s+u,s|=0;return s}};var e=Object.prototype.hasOwnProperty;Object.plain=function(r){return r?r instanceof Object&&r.constructor===Object||Object.prototype.toString.call(r).match(/^\[object (\w+)\]$/)[1]==="Object":!1},Object.empty=function(r,s){for(var d in r)if(e.call(r,d)&&(!s||s.indexOf(d)==-1))return!1;return!0},Object.keys=Object.keys||function(r){var s=[];for(var d in r)e.call(r,d)&&s.push(d);return s},function(){var r,s=setTimeout,d=0,p=0,u=typeof setImmediate!=""+r&&setImmediate||function(f,v){return typeof MessageChannel==""+r?s:((f=new MessageChannel).port1.onmessage=function(k){k.data==""&&v()},function(k){v=k,f.port2.postMessage("")})}(),a=s.check=s.check||typeof performance!=""+r&&performance||{now:function(){return+new Date}};s.hold=s.hold||9,s.poll=s.poll||function(f){if(s.hold>=a.now()-d&&p++<3333){f();return}u(function(){d=a.now(),f()},p=0)}}(),function(){var r=setTimeout,s=r.turn=r.turn||function(v){d.push(v)==1&&p(f)},d=s.s=[],p=r.poll,u=0,a,f=function(){(a=d[u++])&&a(),(u==d.length||u==99)&&(d=s.s=d.slice(u),u=0),d.length&&p(f)}}(),function(){var r,s=setTimeout,d=s.turn;(s.each=s.each||function(p,u,a,f){f=f||9,function v(k,o,b){if(o=(k=(p||[]).splice(0,f)).length){for(var _=0;_<o&&r===(b=u(k[_]));_++);if(r===b){d(v);return}}a&&a(b)}()})()}()})(t,"./shim"),t(function(g){g.exports=function e(a,s,d){if(!a)return{to:e};var p,u=typeof s=="function",a=(this.tag||(this.tag={}))[a]||u&&(this.tag[a]={tag:a,to:e._={next:function(v){var k;(k=this.to)&&k.next(v)}}});if(u){var f={off:e.off||(e.off=function(){if(this.next===e._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=e._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:e._,next:s,the:a,on:this,as:d};return(f.back=a.last||a).to=f,a.last=f}return(a=a.to)&&p!==s&&a.next(s),a}})(t,"./onto"),t(function(g){g.exports=function(e){return e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"&&e!=1/0&&e!=-1/0&&e===e||!!e&&typeof e["#"]=="string"&&Object.keys(e).length===1&&e["#"]}})(t,"./valid"),t(function(g){t("./shim");function e(){var a=+new Date;return p<a?(s=0,p=a+e.drift):p=a+(s+=1)/d+e.drift}e.drift=0;var r=-1/0,s=0,d=999,p=r,u;e.is=function(a,f,v){var k=f&&a&&a._&&a._[">"]||v;if(k)return typeof(k=k[f])=="number"?k:r},e.ify=function(a,f,v,k,o){(a=a||{})._=a._||{},o&&(a._["#"]=o);var b=a._[">"]||(a._[">"]={});return u!==f&&f!=="_"&&(typeof v=="number"&&(b[f]=v),u!==k&&(a[f]=k)),a},g.exports=e})(t,"./state"),t(function(g){t("./shim");function e(r){var s={s:{}},d=s.s;r=r||{max:999,age:1e3*9},s.check=function(u){return d[u]?p(u):!1};var p=s.track=function(u){var a=d[u]||(d[u]={});return a.was=s.now=+new Date,s.to||(s.to=setTimeout(s.drop,r.age+9)),p.ed&&p.ed(u),a};return s.drop=function(u){s.to=null,s.now=+new Date;var a=Object.keys(d);console.STAT&&console.STAT(s.now,+new Date-s.now,"dup drop keys"),setTimeout.each(a,function(f){var v=d[f];v&&(u||r.age)>s.now-v.was||delete d[f]},0,99)},s}g.exports=e})(t,"./dup"),t(function(g){t("./onto"),g.exports=function(s,d){if(this.on){var p=(this.opt||{}).lack||9e3;if(typeof s!="function"){if(!s)return;var a=s["#"]||s,u=(this.tag||"")[a];return u?(d&&(u=this.on(a,d),clearTimeout(u.err),u.err=setTimeout(function(){u.off()},p)),!0):void 0}var a=d&&d["#"]||e(9);if(!s)return a;var f=this.on(a,s,d);return f.err=f.err||setTimeout(function(){f.off(),f.next({err:"Error: No ACK yet.",lack:!0})},p),a}};var e=String.random||function(){return Math.random().toString(36).slice(2)}})(t,"./ask"),t(function(g){function e(o){return o instanceof e?(this._={$:this}).$:this instanceof e?e.create(this._={$:this,opt:o}):new e(o)}e.is=function(o){return o instanceof e||o&&o._&&o===o._.$||!1},e.version=.202,e.chain=e.prototype,e.chain.toJSON=function(){},t("./shim"),e.valid=t("./valid"),e.state=t("./state"),e.on=t("./onto"),e.dup=t("./dup"),e.ask=t("./ask"),function(){e.create=function(h){h.root=h.root||h,h.graph=h.graph||{},h.on=h.on||e.on,h.ask=h.ask||e.ask,h.dup=h.dup||e.dup();var T=h.$.opt(h.opt);return h.once||(h.on("in",o,h),h.on("out",o,h),h.on("put",m,h),e.on("create",h),h.on("create",h)),h.once=1,T};function o(h){if(h){if(h.out===o){this.to.next(h);return}var T=this,E=T.as,B=E.at||E,N=B.$,D=B.dup,G,I=h.DBG;if((G=h["#"])||(G=h["#"]=s(9)),!D.check(G)){if(D.track(G),G=h._,h._=typeof G=="function"?G:function(){},h.$&&h.$===(h.$._||"").$||(h.$=N),h["@"]&&!h.put&&i(h),!B.ask(h["@"],h))if(I&&(I.u=+new Date),h.put){b(h);return}else h.get&&e.on.get(h,N);I&&(I.uc=+new Date),T.to.next(h),I&&(I.ua=+new Date),!(h.nts||h.NTS)&&(h.out=o,B.on("out",h),I&&(I.ue=+new Date))}}}function b(h){if(h){var T=h._||"",E=T.root=((T.$=h.$||"")._||"").root;if(h["@"]&&T.faith&&!T.miss){h.out=o,E.on("out",h);return}T.latch=E.hatch,T.match=E.hatch=[];var B=h.put,N=T.DBG=h.DBG,D=+new Date;if($=$||D,!(B["#"]&&B["."])){N&&(N.p=D),T["#"]=h["#"],T.msg=h,T.all=0,T.stun=1;var G=Object.keys(B);console.STAT&&console.STAT(D,((N||T).pk=+new Date)-D,"put sort");var I=0,U,R,P,L,H,X,J;(function V(it){if(U!=I){if(U=I,!(P=G[I])){console.STAT&&console.STAT(D,((N||T).pd=+new Date)-D,"put"),l(T);return}(L=B[P])?(J=L._)?P!==J["#"]?X=w+A(P)+"soul not same.":(H=J[">"])||(X=w+A(P)+"no state."):X=w+A(P)+"no meta.":X=w+A(P)+"no node.",R=Object.keys(L||{})}if(X){h.err=T.err=X,l(T);return}var xt=0,ht;for(it=it||0;it++<9&&(ht=R[xt++]);)if(ht!=="_"){var Dt=L[ht],Zt=H[ht];if(f===Zt){X=w+A(ht)+"on"+A(P)+"no state.";break}if(!p(Dt)){X=w+A(ht)+"on"+A(P)+"bad "+typeof Dt+A(Dt);break}_(Dt,ht,P,Zt,h),++C}if((R=R.slice(xt)).length){d(V);return}++I,R=null,V(it)})()}}}e.on.put=b;function _(h,T,E,B,N){var D=N._||"",G=D.root,I=G.graph,U,R=I[E]||v,P=u(R,T,1),L=R[T],H=D.DBG;(U=console.STAT)&&(!I[E]||!L)&&(U.has=(U.has||0)+1);var X=O();if(B>X){setTimeout(function(){_(h,T,E,B,N)},(U=B-X)>j?j:U),console.STAT&&console.STAT((H||D).Hf=+new Date,U,"future");return}if(!(B<P)&&!(!D.faith&&B===P&&(h===L||S(h)<=S(L))&&!D.miss)){D.stun++;var J=N["#"]+D.all++,V={toString:function(){return J},_:D};V.toJSON=V.toString,G.dup.track(V)["#"]=N["#"],H&&(H.ph=H.ph||+new Date),G.on("put",{"#":V,"@":N["@"],put:{"#":E,".":T,":":h,">":B},ok:N.ok,_:D})}}function m(h){var T;(T=(h._||"").DBG)&&(T.pa=+new Date,T.pm=T.pm||+new Date);var E=this,B=E.as,N=B.graph,D=h._,G=h.put,I=G["#"],U=G["."],R=G[":"],P=G[">"];h["#"];var L;(L=D.msg)&&(L=L.put)&&(L=L[I])&&a(L,U,P,R,I),N[I]=a(N[I],U,P,R,I),(L=(B.next||"")[I])&&L.on("in",h),l(D),E.to.next(h)}function l(h,T){var E;if(!h.stop&&!(!h.err&&0<--h.stun)&&(h.stop=1,!!(E=h.root))){var B=h.match;B.end=1,B===E.hatch&&(!(B=h.latch)||B.end?delete E.hatch:E.hatch=B),h.hatch&&h.hatch(),setTimeout.each(h.match,function(N){N&&N()}),!(!(T=h.msg)||h.err||T.err)&&(T.out=o,h.root.on("out",T),x())}}function i(h){var T=h["@"]||"",E;if(!(E=T._)){var B=(B=h.$)&&(B=B._)&&(B=B.root)&&(B=B.dup);if(!(B=B.check(T)))return;h["@"]=B["#"]||h["@"];return}E.acks=(E.acks||0)+1,(E.err=h.err)&&(h["@"]=E["#"],l(E)),E.ok=h.ok||E.ok,!E.stop&&!E.crack&&(E.crack=E.match&&E.match.push(function(){y(E)})),y(E)}function y(h){!h||!h.root||h.stun||h.acks!==h.all||h.root.on("in",{"@":h["#"],err:h.err,ok:h.err?f:h.ok||{"":1}})}var w="Error: Invalid graph!",A=function(h){return" '"+(""+h).slice(0,9)+"...' "},S=JSON.stringify,j=2147483647,O=e.state,C=0,$,x=function(){C>999&&C/-($-($=+new Date))>1&&(e.window&&console.log("Warning: You're syncing 1K+ records a second, faster than DOM can update - consider limiting query."),x=function(){C=0})}}(),function(){e.on.get=function(b,_){var m=_._,l=b.get,i=l["#"],y=m.graph[i],w=l["."],A=m.next||(m.next={}),S=A[i],j=b._||{},O=j.DBG=b.DBG;if(O&&(O.g=+new Date),!y)return m.on("get",b);if(w){if((typeof w!="string"||f===y[w])&&!((S||"").next||"")[w]){m.on("get",b);return}y=a({},w,u(y,w),y[w],i)}y&&o(b,y),m.on("get",b)};function o(b,_){var m=+new Date,l=b._||{},i=l.DBG=b.DBG,y=b["#"],w=s(9),A=Object.keys(_||"").sort(),S=((_||"")._||"")["#"];A.length;var j=b.$._.root,O=_===j.graph[S];console.STAT&&console.STAT(m,((i||l).gk=+new Date)-m,"got keys"),_&&function C(){m=+new Date;for(var $=0,x,h={},T;$<9&&(x=A[$++]);)a(h,x,u(_,x),_[x],S);A=A.slice($),(T={})[S]=h,h=T;var E;O&&(E=function(){},E.ram=E.faith=!0),T=A.length,console.STAT&&console.STAT(m,-(m-(m=+new Date)),"got copied some"),i&&(i.ga=+new Date),j.on("in",{"@":y,"#":w,put:h,"%":T?w=s(9):f,$:j.$,_:E,DBG:i,FOO:1}),console.STAT&&console.STAT(m,+new Date-m,"got in"),T&&setTimeout.turn(C)}(),_||j.on("in",{"@":b["#"]})}e.on.get.ack=o}(),function(){e.chain.opt=function(o){o=o||{};var b=this,_=b._,m=o.peers||o;return Object.plain(o)||(o={}),Object.plain(_.opt)||(_.opt=o),typeof m=="string"&&(m=[m]),Object.plain(_.opt.peers)||(_.opt.peers={}),m instanceof Array&&(o.peers={},m.forEach(function(l){var i={};i.id=i.url=l,o.peers[l]=_.opt.peers[l]=_.opt.peers[l]||i})),r(o,function l(i){var y=this[i];if(this&&this.hasOwnProperty(i)||typeof y=="string"||Object.empty(y)){this[i]=y;return}y&&y.constructor!==Object&&!(y instanceof Array)||r(y,l)}),_.opt.from=o,e.on("opt",_),_.opt.uuid=_.opt.uuid||function(i){return e.state().toString(36).replace(".","")+String.random(i||12)},b}}();var r=function(o,b){Object.keys(o).forEach(b,o)},s=String.random,d=setTimeout.turn,p=e.valid,u=e.state.is,a=e.state.ify,f,v={},k;e.log=function(){return!e.log.off&&k.log.apply(k,arguments),[].slice.call(arguments).join(" ")},e.log.once=function(o,b,_){return(_=e.log.once)[o]=_[o]||0,_[o]++||e.log(b)},typeof window<"u"&&((window.GUN=window.Gun=e).window=window);try{typeof c<"u"&&(c.exports=e)}catch{}g.exports=e,(e.window||{}).console=(e.window||{}).console||{log:function(){}},(k=console).only=function(o,b){return k.only.i&&o===k.only.i&&k.only.i++&&(k.log.apply(k,arguments)||b)},e.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, please ask for help on http://chat.gun.eco if anything takes you longer than 5min to figure out!")})(t,"./root"),t(function(g){var e=t("./root");e.chain.back=function(d,p){var u;if(d=d||1,d===-1||d===1/0)return this._.root.$;if(d===1)return(this._.back||this._).$;var a=this,f=a._;if(typeof d=="string"&&(d=d.split(".")),d instanceof Array){var v=0,k=d.length,u=f;for(v;v<k;v++)u=(u||r)[d[v]];return s!==u?p?a:u:(u=f.back)?u.$.back(d,p):void 0}if(typeof d=="function"){for(var o,u={back:f};(u=u.back)&&s===(o=d(u,p)););return o}return typeof d=="number"?(f.back||f).$.back(d-1):this};var r={},s})(t,"./back"),t(function(g){var e=t("./root");e.chain.chain=function(l){var i=this,y=i._,w=new(l||i).constructor(i),A=w._,S;return A.root=S=y.root,A.id=++S.once,A.back=i._,A.on=e.on,A.on("in",e.on.in,A),A.on("out",e.on.out,A),w};function r(l){var i,y=this.as,w=y.back,A=y.root,S;if(l.$||(l.$=y.$),this.to.next(l),y.err){y.on("in",{put:y.put=f,$:y.$});return}if(i=l.get){if(A.pass&&(A.pass[y.id]=y),y.lex&&Object.keys(y.lex).forEach(function(j){S[j]=y.lex[j]},S=l.get=l.get||{}),i["#"]||y.soul){if(i["#"]=i["#"]||y.soul,l["#"]||(l["#"]=v(9)),w=A.$.get(i["#"])._,i=i["."]){if(o(w.put,i)&&(S=w.ask&&w.ask[i],(w.ask||(w.ask={}))[i]=w.$.get(i)._,w.on("in",{get:i,put:{"#":w.soul,".":i,":":w.put[i],">":_(A.graph[w.soul],i)}}),S))return}else{if(S=w.ask&&w.ask[""],(w.ask||(w.ask={}))[""]=w,f!==w.put&&(w.on("in",w),S))return;l.$=w.$}return A.ask(u,l),A.on("in",l)}if(i["."])return y.get?(l={get:{".":y.get},$:y.$},(w.ask||(w.ask={}))[y.get]=l.$._,w.on("out",l)):(l={get:y.lex?l.get:{},$:y.$},w.on("out",l));if((y.ask||(y.ask={}))[""]=y,y.get)return i["."]=y.get,(w.ask||(w.ask={}))[y.get]=l.$._,w.on("out",l)}return w.on("out",l)}e.on.out=r;function s(l,i){i=i||this.as;var y=i.root,w=l.$||(l.$=i.$),A=(w||"")._||a,S=l.put||"",j=S["#"],O=S["."],C=f!==S["="]?S["="]:S[":"],$=S[">"]||-1/0,x;if(f!==l.put&&(f===S["#"]||f===S["."]||f===S[":"]&&f===S["="]||f===S[">"])){if(!k(S)){if(!(j=((S||"")._||"")["#"])){console.log("chain not yet supported for",S,"...",l,i);return}return w=i.root.$.get(j),setTimeout.each(Object.keys(S).sort(),function(h){h=="_"||f===($=_(S,h))||i.on("in",{$:w,put:{"#":j,".":h,"=":S[h],">":$},VIA:l})})}i.on("in",{$:A.back.$,put:{"#":j=A.back.soul,".":O=A.has||A.get,"=":S,">":_(A.back.put,O)},via:l});return}(l.seen||"")[i.id]||((l.seen||(l.seen=function(){}))[i.id]=i,i!==A&&(Object.keys(l).forEach(function(h){S[h]=l[h]},S={}),S.get=i.get||S.get,!i.soul&&!i.has?S.$$$=S.$$$||i.$:A.soul&&(S.$=i.$,S.$$=S.$$||A.$),l=S),p(l,i),(i.soul||l.$$)&&$>=_(y.graph[j],O)&&((S=y.$.get(j)._).put=m(S.put,O,$,C,j)),!A.soul&&$>=_(y.graph[j],O)&&(x=(y.$.get(j)._.next||"")[O])&&(x.put=C,typeof(S=k(C))=="string"&&(x.put=y.$.get(S)._.put||C)),this.to&&this.to.next(l),i.any&&setTimeout.each(Object.keys(i.any),function(h){(h=i.any[h])&&h(l)},0,99),i.echo&&setTimeout.each(Object.keys(i.echo),function(h){(h=i.echo[h])&&h.on("in",l)},0,99),((l.$$||"")._||A).soul&&(x=i.next)&&(x=x[O])&&(S={},Object.keys(l).forEach(function(h){S[h]=l[h]}),S.$=(l.$$||l.$).get(S.get=O),delete S.$$,delete S.$$$,x.on("in",S)),d(l,i))}e.on.in=s;function d(l,i){if(i=i||this.as||l.$._,!(l.$$&&this!==e.on)&&!(!l.put||i.soul)){var y=l.put||"",w=y["="]||y[":"],O,A=i.root,S=A.$.get(y["#"]).get(y["."])._;if(typeof(w=k(w))!="string"){this===e.on&&((S.echo||(S.echo={}))[i.id]=i);return}if(!((S.echo||(S.echo={}))[i.id]&&!(A.pass||"")[i.id])){if(O=A.pass){if(O[w+i.id])return;O[w+i.id]=1}(S.echo||(S.echo={}))[i.id]=i,i.has&&(i.link=w);var j=A.$.get(S.link=w)._;(j.echo||(j.echo={}))[S.id]=S;var O=i.ask||"";(O[""]||i.lex)&&j.on("out",{get:{"#":w}}),setTimeout.each(Object.keys(O),function(C,$){!C||!($=O[C])||$.on("out",{get:{"#":w,".":C}})},0,99)}}}e.on.link=d;function p(l,i){var y=l.put||"",w=f!==y["="]?y["="]:y[":"],A=i.root,S,j;if(f===w){if(i.soul&&f!==i.put||(j=(l.$$||l.$||"")._||"",l["@"]&&(f!==j.put||f!==i.put)))return;(S=i.link||l.linked)&&delete(A.$.get(S)._.echo||"")[i.id],i.has&&(i.link=null),i.put=f,setTimeout.each(Object.keys(i.next||""),function(O,C){(C=i.next[O])&&(S&&delete(A.$.get(S).get(O)._.echo||"")[C.id],C.on("in",{get:O,put:f,$:C.$}))},0,99);return}i.soul||l.$$||(S=k(w),j=l.$._||"",!((S===j.link||i.has&&!j.link)&&!((A.pass||"")[i.id]&&typeof S!="string"))&&(delete(j.echo||"")[i.id],p({get:i.get,put:f,$:l.$,linked:l.linked=l.linked||j.link},i)))}e.on.unlink=p;function u(l,i){var y=this.as,w=y.$._;w.root;var A=y.get||"",S=(l.put||"")[A["#"]]||"";if(!l.put||typeof A["."]=="string"&&f===S[A["."]]){if(f!==w.put||!w.soul&&!w.has)return;w.ack=(w.ack||0)+1,w.on("in",{get:w.get,put:w.put=f,$:w.$,"@":l["@"]});return}(l._||{}).miss=1,e.on.put(l)}var a={},f,v=String.random,k=e.valid,o=function(l,i){return l&&Object.prototype.hasOwnProperty.call(l,i)},b=e.state,_=b.is,m=b.ify})(t,"./chain"),t(function(g){var e=t("./root");e.chain.get=function(f,v,k){var o,b;if(typeof f=="string"){if(f.length==0)return(o=this.chain())._.err={err:e.log("0 length key!",f)},v&&v.call(o,o._.err),o;var _=this,m=_._,l=m.next||p;(o=l[f])||(o=f&&r(f,_)),o=o&&o.$}else if(typeof f=="function"){let O=function(C,$,x){if(!O.stun&&!((D=y.pass)&&!D[w])){var h=C.$._,T=(C.$$||"")._,E=(T||h).put,B=!h.has&&!h.soul,N={},D;if((B||a===E)&&(E=a===((D=C.put)||"")["="]?a===(D||"")[":"]?D:D[":"]:D["="]),typeof(D=e.valid(E))=="string"&&(E=a===(D=y.$.get(D)._.put)?i.not?a:E:D),!(i.not&&a===E)){if(a===i.stun){if((D=y.stun)&&D.on&&(m.$.back(function(G){if(D.on(""+G.id,N={}),(N.run||0)<O.id)return N}),!N.run&&D.on(""+h.id,N={}),!N.run&&T&&D.on(""+T.id,N={}),O.id>N.run&&((!N.stun||N.stun.end)&&(N.stun=D.on("stun"),N.stun=N.stun&&N.stun.last),N.stun&&!N.stun.end))){(N.stun.add||(N.stun.add={}))[w]=function(){O(C,$,1)};return}if(a===E&&(x=0),(D=y.hatch)&&!D.end&&a===i.hatch&&!x){if(A[h.$._.id])return;A[h.$._.id]=1,D.push(function(){O(C,$,1)});return}A={}}if(y.pass){if(y.pass[w+h.id])return;y.pass[w+h.id]=1}if(i.on){i.ok.call(h.$,E,h.get,C,$||O);return}if(i.v2020){i.ok(C,$||O);return}Object.keys(C).forEach(function(G){D[G]=C[G]},D={}),C=D,C.put=E,i.ok.call(i.as,C,$||O)}}};var S=O;if(v===!0)return s(this,f,v,k),this;o=this;var m=o._,i=v||{},y=m.root,w;i.at=m,i.ok=f;var A={};return O.at=m,(m.any||(m.any={}))[w=String.random(7)]=O,O.off=function(){O.stun=1,m.any&&delete m.any[w]},O.rid=d,O.id=i.run||++y.once,b=y.pass,(y.pass={})[w]=1,i.out=i.out||{get:{}},m.on("out",i.out),y.pass=b,o}else{if(typeof f=="number")return this.get(""+f,v,k);if(typeof(b=u(f))=="string")return this.get(b,v,k);(b=this.get.next)&&(o=b(this,f))}return o?(v&&typeof v=="function"&&o.get(v,k),o):((o=this.chain())._.err={err:e.log("Invalid get request!",f)},v&&v.call(o,o._.err),o)};function r(f,v){var k=v._,o=k.next,b=v.chain(),_=b._;return o||(o=k.next={}),o[_.get=f]=_,v===k.root.$?_.soul=f:(k.soul||k.has)&&(_.has=f),_}function s(f,v,k,o){var b=f._,_=0,m;return(m=b.soul||b.link)?v(m,o,b):b.jam?b.jam.push([v,o]):(b.jam=[[v,o]],f.get(function(i,y){if(!(a===i.put&&!b.root.opt.super&&(m=Object.keys(b.root.opt.peers).length)&&++_<=m)){y.rid(i);var w=(w=i.$)&&w._||{},A=0,S;for(m=b.jam,delete b.jam;S=m[A++];){var j=S[0];S=S[1],j&&j(w.link||w.soul||e.valid(i.put)||((i.put||{})._||{})["#"],S,i,y)}}},{out:{get:{".":!0}}}),f)}function d(f){var v=this.at||this.on;if(!f||v.soul||v.has)return this.off();if(f=(f=(f=f.$||f)._||f).id){v.map;var k;if((k=this.seen||(this.seen={}))[f])return!0;k[f]=!0}}var p={},u=e.valid,a})(t,"./get"),t(function(g){var e=t("./root");e.chain.put=function(o,b,_){var m=this,l=m._,i=l.root;_=_||{},_.root=l.root,_.run||(_.run=i.once),r(_,l.id),_.ack=_.ack||b,_.via=_.via||m,_.data=_.data||o,_.soul||(_.soul=l.soul||typeof b=="string"&&b);var y=_.state=_.state||e.state();return typeof o=="function"?(o(function(w){_.data=w,m.put(u,u,_)}),m):_.soul?(_.$=i.$.get(_.soul),_.todo=[{it:_.data,ref:_.$}],_.turn=_.turn||f,_.ran=_.ran||s,function w(){var A=_.todo,S=A.pop(),j=S.it;S.ref&&S.ref._.id;var O,C,$,x,h;if(r(_,S.ref),(x=S.todo)&&(C=x.pop(),j=j[C],x.length&&A.push(S)),C&&(A.path||(A.path=[])).push(C),!(O=v(j))&&!(h=e.is(j))){if(!Object.plain(j)){s.err(_,"Invalid data: "+p(j)+" at "+(_.via.back(function(D){D.get&&x.push(D.get)},x=[])||x.join("."))+"."+(A.path||[]).join("."));return}for(var T=_.seen||(_.seen=[]),E=T.length;E--;)if(j===(x=T[E]).it){O=j=x.link;break}}if(C&&O)S.node=k(S.node,C,y,j);else{let D=function(G,I){var U=$.link["#"];I&&(I.off(),I.rid(G));var R=U||G.soul||(x=(G.$$||G.$)._||"").soul||x.link||((x=x.put||"")._||"")["#"]||x["#"]||((x=G.put||"")&&G.$$?x["#"]:(x["="]||x[":"]||"")["#"]);if(!U&&r(_,G.$),!R&&!S.link["#"]){(S.wait||(S.wait=[])).push(function(){D(G,I)});return}R||(R=[],(G.$$||G.$).back(function(P){if(x=P.soul||P.link)return R.push(x);R.push(P.get)}),R=R.reverse().join("/")),$.link["#"]=R,!h&&(((_.graph||(_.graph={}))[R]=$.node||($.node={_:{}}))._["#"]=R),delete _.wait[B],$.wait&&setTimeout.each($.wait,function(P){P&&P()}),_.ran(_)};var N=D;if(!_.seen){s.err(_,"Data at root of graph must be a node (an object).");return}_.seen.push($={it:j,link:{},todo:h?[]:Object.keys(j).sort().reverse(),path:(A.path||[]).slice(),up:S}),S.node=k(S.node,C,y,$.link),!h&&$.todo.length&&A.push($);var B=_.seen.length;(_.wait||(_.wait={}))[B]="",x=($.ref=h?j:C?S.ref.get(C):S.ref)._,(x=j&&(j._||"")["#"]||x.soul||x.link)?D({soul:x}):$.ref.get(D,{run:_.run,v2020:1,out:{get:{".":" "}}})}if(!A.length)return _.ran(_);_.turn(w)}(),m):(d(_),m)};function r(o,b){if(b){b=(b._||"").id||b;var _=o.root.stun||(o.root.stun={on:e.on}),m={},l;o.stun||(o.stun=_.on("stun",function(){})),(l=_.on(""+b))&&l.the.last.next(m),!(m.run>=o.run)&&_.on(""+b,function(i){if(o.stun.end){this.off(),this.to.next(i);return}i.run=i.run||o.run,i.stun=i.stun||o.stun})}}function s(o){if(o.err){s.end(o.stun,o.root);return}if(!(o.todo.length||o.end||!Object.empty(o.wait))){o.end=1;var b=o.$.back(-1)._,_=b.root,m=b.ask(function(w){_.on("ack",w),w.err&&!w.lack&&e.log(w),++l>(o.acks||0)&&this.off(),o.ack&&o.ack(w,this)},o.opt),l=0,i=o.stun,y;(y=function(){i&&(s.end(i,_),setTimeout.each(Object.keys(i=i.add||""),function(w){(w=i[w])&&w()}))}).hatch=y,o.ack&&!o.ok&&(o.ok=o.acks||9),o.via._.on("out",{put:o.out=o.graph,ok:o.ok&&{"@":o.ok+1},opt:o.opt,"#":m,_:y})}}s.end=function(o,b){o.end=a,o.the.to===o&&o===o.the.last&&delete b.stun,o.off()},s.err=function(o,b){(o.ack||a).call(o,o.out={err:o.err=e.log(b)}),o.ran(o)};function d(o){var b=o.via._,_;o.via=o.via.back(function(m){if(m.soul||!m.get)return m.$;_=o.data,(o.data={})[m.get]=_}),(!o.via||!o.via._.soul)&&(o.via=b.root.$.get(((o.data||"")._||"")["#"]||b.$.back("opt.uuid")())),o.via.put(o.data,o.ack,o)}function p(o,b){return o&&(b=o.constructor)&&b.name||typeof o}var u,a=function(){},f=setTimeout.turn,v=e.valid,k=e.state.ify})(t,"./put"),t(function(g){var e=t("./root");t("./chain"),t("./back"),t("./put"),t("./get"),g.exports=e})(t,"./index"),t(function(g){var e=t("./index");e.chain.on=function(d,p,u,a){var f=this,v=f._;v.root;var k;if(typeof d=="string")return p?(k=v.on(d,p,u||v,a),u&&u.$&&(u.subs||(u.subs=[])).push(k),f):v.on(d);var o=p;return(o=o===!0?{change:!0}:o||{}).not=1,o.on=1,f.get(d,o),f},e.chain.once=function(d,p){if(p=p||{},!d)return r(this);var u=this,a=u._,f=a.root;a.put;var v=String.random(7),k;return u.get(function(o,b,_,m){var l=this,i=l._,y=i.one||(i.one={});if(m.stun||y[v]==="")return;if((k=e.valid(o))===!0){w();return}if(typeof k=="string")return;clearTimeout((a.one||"")[v]),clearTimeout(y[v]),y[v]=setTimeout(w,p.wait||99);function w(A){if(!i.has&&!i.soul&&(i={put:o,get:b}),s===(k=i.put)&&(k=((_.$$||"")._||"").put),typeof e.valid(k)=="string"&&(k=f.$.get(k)._.put,k===s&&!A)){y[v]=setTimeout(function(){w(1)},p.wait||99);return}m.stun||y[v]!==""&&(y[v]="",(a.soul||a.has)&&m.off(),d.call(l,k,i.get),clearTimeout(y[v]))}},{on:1}),u};function r(d,p,u){return e.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),(u=d.chain())._.nix=d.once(function(a,f){u._.on("in",this._)}),u._.lex=d._.lex,u}e.chain.off=function(){var d=this,p=d._,u,a=p.back;if(a)return p.ack=0,(u=a.next)&&u[p.get]&&delete u[p.get],(u=a.any)&&(delete a.any,a.any={}),(u=a.ask)&&delete u[p.get],(u=a.put)&&delete u[p.get],(u=p.soul)&&delete a.root.graph[u],(u=p.map)&&Object.keys(u).forEach(function(f,v){v=u[f],v.link&&a.root.$.get(v.link).off()}),(u=p.next)&&Object.keys(u).forEach(function(f,v){v=u[f],v.$.off()}),p.on("off",{}),d};var s})(t,"./on"),t(function(g){var e=t("./index"),r=e.chain.get.next;e.chain.get.next=function(u,a){var f;return Object.plain(a)?(f=((f=a["#"])||"")["="]||f)?u.get(f):((f=u.chain()._).lex=a,u.on("in",function(v){String.match(v.get||(v.put||"")["."],a["."]||a["#"]||a)&&f.on("in",v),this.to.next(v)}),f.$):(r||d)(u,a)},e.chain.map=function(u,a,f){var v=this,k=v._,o,b;return Object.plain(u)&&(o=u["."]?u:{".":u},u=p),u?(e.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),b=v.chain(),v.map().on(function(_,m,l,i){var y=(u||d).call(this,_,m,l,i);if(p!==y){if(_===y)return b._.on("in",l);if(e.is(y))return b._.on("in",y._);var w={};Object.keys(l.put).forEach(function(A){w[A]=l.put[A]},w),w["="]=y,b._.on("in",{get:m,put:w})}}),b):((b=k.each)||((k.each=b=v.chain())._.lex=o||b._.lex||k.lex,b._.nix=v.back("nix"),v.on("in",s,b._)),b)};function s(u){this.to.next(u);var a=this.as,f=u.$,v=f._,k=u.put,o;!v.soul&&!u.$$||(o=a.lex)&&!String.match(u.get||(k||"")["."],o["."]||o["#"]||o)||e.on.link(u,a)}var d=function(){},p})(t,"./map"),t(function(g){var e=t("./index");e.chain.set=function(r,s,d){var p=this,u=p.back(-1),a,f;return s=s||function(){},d=d||{},d.item=d.item||r,(a=((r||"")._||"")["#"])&&((r={})["#"]=a),typeof(f=e.valid(r))=="string"?p.get(a=f).put(r,s,d):e.is(r)?(p.put(function(v){r.get(function(k,o,b){if(!k)return s.call(p,{err:e.log('Only a node can be linked! Not "'+b.put+'"!')});(f={})[k]={"#":k},v(f)},!0)}),r):(Object.plain(r)&&(r=u.get(a=p.back("opt.uuid")()).put(r)),p.get(a||u.back("opt.uuid")(7)).put(r,s,d))}})(t,"./set"),t(function(g){t("./shim");var e=function(){},r=JSON.parseAsync||function(u,a,f){var v,k=+new Date;try{a(v,JSON.parse(u,f),s.sucks(+new Date-k))}catch(o){a(o)}},s=JSON.stringifyAsync||function(u,a,f,v){var k,o=+new Date;try{a(k,JSON.stringify(u,f,v),s.sucks(+new Date-o))}catch(b){a(b)}};s.sucks=function(u){u>99&&(console.log("Warning: JSON blocking CPU detected. Add `gun/lib/yson.js` to fix."),s.sucks=e)};function d(u){var a=function(){},f=u.opt||{};f.log=f.log||console.log,f.gap=f.gap||f.wait||0,f.max=f.max||(f.memory?f.memory*999*999:3e8)*.3,f.pack=f.pack||f.max*.01*.01,f.puff=f.puff||9;var v=setTimeout.turn||setTimeout,k=u.dup,o=k.check,b=k.track,_=a.hear=function(i,y){if(i){if(f.max<=i.length)return a.say({dam:"!",err:"Message too big!"},y);a===this&&(_.d+=i.length||0,++_.c);var w=y.SH=+new Date,A=i[0],S;if(A==="["){r(i,function(j,O){if(j||!O)return a.say({dam:"!",err:"DAM JSON parse error."},y);console.STAT&&console.STAT(+new Date,O.length,"# on hear batch");var C=f.puff;(function $(){for(var x=+new Date,h=0,T;h<C&&(T=O[h++]);)a.hear(T,y);O=O.slice(h),console.STAT&&console.STAT(x,+new Date-x,"hear loop"),m(y),O.length&&v($,0)})()}),i="";return}if(A==="{"||(i["#"]||Object.plain(i))&&(S=i)){if(S)return _.one(S,y,w);r(i,function(j,O){if(j||!O)return a.say({dam:"!",err:"DAM JSON parse error."},y);_.one(O,y,w)});return}}};_.one=function(i,y,$){var A,S,j,O,C;if(i.DBG&&(i.DBG=C={DBG:i.DBG}),C&&(C.h=$),C&&(C.hp=+new Date),(A=i["#"])||(A=i["#"]=String.random(9)),!(j=o(A))&&(S=i["##"],!(S&&(j=i["@"]||i.get&&A)&&k.check(O=j+S)))){if((i._=function(){}).via=a.leap=y,(j=i["><"])&&typeof j=="string"&&j.slice(0,99).split(",").forEach(function(x){this[x]=1},i._.yo={}),j=i.dam){(j=a.hear[j])&&j(i,y,u),b(A);return}(j=i.ok)&&(i._.near=j["/"]);var $=+new Date;C&&(C.is=$),y.SI=A,b.ed=function(x){A===x&&(b.ed=0,(x=k.s[A])&&(x.via=y,i.get&&(x.it=i)))},u.on("in",a.last=i),C&&(C.hd=+new Date),console.STAT&&console.STAT($,+new Date-$,i.get?"msg get":i.put?"msg put":"msg"),b(A),O&&b(O),a.leap=a.last=null}},_.c=_.d=0,function(){var i=0,y;a.hash=function(S,j){var O,C,$,x=+new Date;s(S.put,function h(T,E){var B=(C||(C=$=E||"")).slice(0,32768);if(O=String.hash(B,O),C=C.slice(32768),C){v(h,0);return}console.STAT&&console.STAT(x,+new Date-x,"say json+hash"),S._.$put=$,S["##"]=O,a.say(S,j),delete S._.$put},w)};function w(S,j){var O;return j instanceof Object?(Object.keys(j).sort().forEach(A,{to:O={},on:j}),O):j}function A(S){this.to[S]=this.on[S]}a.say=function(S,j){var O;if((O=this)&&(O=O.to)&&O.next&&O.next(S),!S)return!1;var C,$,x,h=S["@"],T=S._||(S._=function(){}),E=S.DBG,B=+new Date;if(T.y=T.y||B,j||E&&(E.y=B),(C=S["#"])||(C=S["#"]=String.random(9)),!y&&b(C),!($=S["##"])&&p!==S.put&&!T.via&&h){a.hash(S,j);return}if(!j&&h&&(j=(O=k.s[h])&&(O.via||(O=O.it)&&(O=O._)&&O.via)||(O=a.last)&&h===O["#"]&&a.leap),!j&&h)return k.s[h]?void 0:(console.STAT&&console.STAT(+new Date,++i,"total no peer to ack to"),!1);if(h&&!S.put&&!$&&((k.s[h]||"").it||"")["##"])return!1;if(!j&&a.way)return a.way(S);if(E&&(E.yh=+new Date),!(x=T.raw)){a.raw(S,j);return}if(E&&(E.yr=+new Date),!j||!j.id){if(!Object.plain(j||f.peers))return!1;var B=+new Date;f.puff;var N=f.peers,D=Object.keys(j||f.peers||{});console.STAT&&console.STAT(B,+new Date-B,"peer keys"),function U(){var R=+new Date;y=1;var P=T.raw;T.raw=x;for(var L=0,H;L<9&&(H=(D||"")[L++]);)(H=N[H]||(j||"")[H])&&a.say(S,H);T.raw=P,y=0,D=D.slice(L),console.STAT&&console.STAT(R,+new Date-R,"say loop"),D.length&&(v(U,0),h&&b(h))}();return}if(!j.wire&&a.wire&&a.wire(j),C!==j.last){if(j.last=C,j===T.via||(O=T.yo)&&(O[j.url]||O[j.pid]||O[j.id]))return!1;if(console.STAT&&console.STAT(B,((E||T).yp=+new Date)-(T.y||B),"say prep"),!y&&h&&b(h),j.batch){if(j.tail=(O=j.tail||0)+x.length,j.tail<=f.pack){j.batch+=(O?",":"")+x;return}m(j)}j.batch="[";var G=+new Date;setTimeout(function(){console.STAT&&console.STAT(G,+new Date-G,"0ms TO"),m(j)},f.gap),l(x,j),console.STAT&&h===j.SI&&console.STAT(B,+new Date-j.SH,"say ack")}},a.say.c=a.say.d=0,a.raw=function(S,j){if(!S)return"";var O=S._||{},C,$;if($=O.raw)return $;if(typeof S=="string")return S;var x=S["##"],h=S["@"];if(x&&h){if(!O.via&&o(h+x))return!1;if($=(k.s[h]||"").it){if(x===$["##"])return!1;$["##"]||($["##"]=x)}}if(!S.dam&&!S["@"]){var T=0,E=[];$=f.peers;for(var B in $){var N=$[B];if(E.push(N.url||N.pid||N.id),++T>6)break}T>1&&(S["><"]=E.join())}if(S.put&&($=S.ok)&&(S.ok={"@":($["@"]||1)-1,"/":$["/"]==S._.near?a.near:$["/"]}),C=O.$put){$={},Object.keys(S).forEach(function(G){$[G]=S[G]}),$.put=":])([:",s($,function(G,I){if(!G){var U=+new Date;$=I.indexOf('"put":":])([:"'),D(p,I=I.slice(0,$+6)+C+I.slice($+14)),console.STAT&&console.STAT(U,+new Date-U,"say slice")}});return}s(S,D);function D(G,I){G||(O.raw=I,a.say(S,j))}}}();function m(i){var y=i.batch,w=typeof y=="string";if(w&&(y+="]"),i.batch=i.tail=null,!!y&&!(w?3>y.length:!y.length)){if(!w)try{y=y.length===1?y[0]:JSON.stringify(y)}catch(A){return f.log("DAM JSON stringify error",A)}y&&l(y,i)}}function l(i,y){try{var w=y.wire;y.say?y.say(i):w.send&&w.send(i),a.say.d+=i.length||0,++a.say.c}catch{(y.queue=y.queue||[]).push(i)}}return a.near=0,a.hi=function(i){var y=i.wire,w;if(!y){a.wire(i.length&&{url:i,id:i}||i);return}i.id?f.peers[i.url||i.id]=i:(w=i.id=i.id||i.url||String.random(9),a.say({dam:"?",pid:u.opt.pid},f.peers[w]=i),delete k.s[i.last]),i.met||(a.near++,i.met=+new Date,u.on("hi",i)),w=i.queue,i.queue=[],setTimeout.each(w||[],function(A){l(A,i)},0,9)},a.bye=function(i){i.met&&--a.near,delete i.met,u.on("bye",i);var y=+new Date;y=y-(i.met||y),a.bye.time=((a.bye.time||y)+y)/2},a.hear["!"]=function(i,y){f.log("Error:",i.err)},a.hear["?"]=function(i,y){i.pid&&(y.pid||(y.pid=i.pid),i["@"])||(a.say({dam:"?",pid:f.pid,"@":i["#"]},y),delete k.s[y.last])},a.hear.mob=function(i,y){if(i.peers){var w=Object.keys(i.peers),A=w[Math.random()*w.length>>0];A&&(a.bye(y),a.hi(A))}},u.on("create",function(i){i.opt.pid=i.opt.pid||String.random(9),this.to.next(i),i.on("out",a.say)}),u.on("bye",function(i,y){i=f.peers[i.id||i]||i,this.to.next(i),i.bye?i.bye():(y=i.wire)&&y.close&&y.close(),delete f.peers[i.id],i.wire=null}),u.on("bye",function(i,y){this.to.next(i),(y=console.STAT)&&(y.peers=a.near),(y=i.url)&&setTimeout(function(){},f.lack||9e3)}),u.on("hi",function(i,y){if(this.to.next(i),(y=console.STAT)&&(y.peers=a.near),!f.super){var w=Object.keys(u.next||"");w.length>9999&&!console.SUBS&&console.log(console.SUBS="Warning: You have more than 10K live GETs, which might use more bandwidth than your screen can show - consider `.off()`."),setTimeout.each(w,function(A){var S=u.next[A];if(f.super||(S.ask||"")[""]){a.say({get:{"#":A}},i);return}setTimeout.each(Object.keys(S.ask||""),function(j){j&&a.say({"##":String.hash((u.graph[A]||"")[j]),get:{"#":A,".":j}},i)})})}}),a}var p;try{g.exports=d}catch{}})(t,"./mesh"),t(function(g){var e=t("./index");e.Mesh=t("./mesh"),e.on("opt",function(s){if(this.to.next(s),s.once)return;var d=s.opt;if(d.WebSocket===!1)return;var p=e.window||{},u=d.WebSocket||p.WebSocket||p.webkitWebSocket||p.mozWebSocket;if(!u)return;d.WebSocket=u;var a=d.mesh=d.mesh||e.Mesh(s);a.wire||d.wire,a.wire=d.wire=f;function f(b){try{if(!b||!b.url)return m&&m(b);var _=b.url.replace(/^http/,"ws"),m=b.wire=new d.WebSocket(_);return m.onclose=function(){k(b),d.mesh.bye(b)},m.onerror=function(l){k(b)},m.onopen=function(){d.mesh.hi(b)},m.onmessage=function(l){l&&d.mesh.hear(l.data||l,b)},m}catch{d.mesh.bye(b)}}setTimeout(function(){!d.super&&s.on("out",{dam:"hi"})},1);var v=2*999;function k(b){clearTimeout(b.defer),d.peers[b.url]&&(o&&b.retry<=0||(b.retry=(b.retry||d.retry+1||60)-(-b.tried+(b.tried=+new Date)<v*4?1:0),b.defer=setTimeout(function _(){if(o&&o.hidden)return setTimeout(_,v);f(b)},v)))}var o=""+r!=typeof document&&document});var r})(t,"./websocket"),t(function(g){if(!(typeof Gun>"u")){var e=function(){},r;try{r=(Gun.window||e).localStorage}catch{}r||(Gun.log("Warning: No localStorage exists to persist data to!"),r={setItem:function(d,p){this[d]=p},removeItem:function(d){delete this[d]},getItem:function(d){return this[d]}});var s=JSON.stringifyAsync||function(d,p,u,a){var f;try{p(f,JSON.stringify(d,u,a))}catch(v){p(v)}};Gun.on("create",function d(p){this.to.next(p);var u=p.opt;p.graph;var a=[],f,v,k,o;if(u.localStorage===!1)return;u.prefix=u.file||"gun/";try{f=d[u.prefix]=d[u.prefix]||JSON.parse(k=r.getItem(u.prefix))||{}}catch{f=d[u.prefix]={}}k=(k||"").length,p.on("get",function(_){this.to.next(_);var m=_.get,l,i,y,w;!m||!(l=m["#"])||(i=f[l]||w,i&&(y=m["."])&&!Object.plain(y)&&(i=Gun.state.ify({},y,Gun.state.is(i,y),i[y],l)),Gun.on.get.ack(_,i))}),p.on("put",function(_){this.to.next(_);var m=_.put,l=m["#"],i=m["."],y=_["#"],w=_.ok||"";if(f[l]=Gun.state.ify(f[l],i,m[">"],m[":"],l),o&&k>4999880){p.on("in",{"@":y,err:"localStorage max!"});return}!_["@"]&&(!_._.via||Math.random()<w["@"]/w["/"])&&a.push(y),!v&&(v=setTimeout(b,9+k/333))});function b(){if(!a.length&&((setTimeout.turn||"").s||"").length){setTimeout(b,99);return}var _=a;clearTimeout(v),v=!1,a=[],s(f,function(m,l){try{!m&&r.setItem(u.prefix,l)}catch(i){m=o=i||"localStorage failure"}m&&(Gun.log(m+" Consider using GUN's IndexedDB plugin for RAD for more storage space, https://gun.eco/docs/RAD#install"),p.on("localStorage:error",{err:m,get:u.prefix,put:f})),k=l.length,setTimeout.each(_,function(i){p.on("in",{"@":i,err:m,ok:0})},0,99)})}})}})(t,"./localStorage")})(),function(){var $;if(""+$!=typeof Gun){var t=function(x){console.warn("Warning! Deprecated internal utility will break in next version:",x)},c=Gun;c.fn=c.fn||{is:function(x){return t("fn"),!!x&&typeof x=="function"}},c.bi=c.bi||{is:function(x){return t("bi"),x instanceof Boolean||typeof x=="boolean"}},c.num=c.num||{is:function(x){return t("num"),!g(x)&&(x-parseFloat(x)+1>=0||x===1/0||x===-1/0)}},c.text=c.text||{is:function(x){return t("text"),typeof x=="string"}},c.text.ify=c.text.ify||function(x){return t("text.ify"),c.text.is(x)?x:typeof JSON<"u"?JSON.stringify(x):x&&x.toString?x.toString():x},c.text.random=c.text.random||function(x,h){t("text.random");var T="";for(x=x||24,h=h||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";x>0;)T+=h.charAt(Math.floor(Math.random()*h.length)),x--;return T},c.text.match=c.text.match||function(x,h){var T,E;return t("text.match"),typeof x!="string"?!1:(typeof h=="string"&&(h={"=":h}),h=h||{},T=h["="]||h["*"]||h[">"]||h["<"],x===T?!0:E!==h["="]?!1:(T=h["*"]||h[">"]||h["<"],x.slice(0,(T||"").length)===T?!0:E!==h["*"]?!1:E!==h[">"]&&E!==h["<"]?x>=h[">"]&&x<=h["<"]:E!==h[">"]&&x>=h[">"]||E!==h["<"]&&x<=h["<"]))},c.text.hash=c.text.hash||function(x,h){if(t("text.hash"),typeof x=="string"){if(h=h||0,!x.length)return h;for(var T=0,E=x.length,B;T<E;++T)B=x.charCodeAt(T),h=(h<<5)-h+B,h|=0;return h}},c.list=c.list||{is:function(x){return t("list"),x instanceof Array}},c.list.slit=c.list.slit||Array.prototype.slice,c.list.sort=c.list.sort||function(x){return t("list.sort"),function(h,T){return!h||!T?0:(h=h[x],T=T[x],h<T?-1:h>T?1:0)}},c.list.map=c.list.map||function(x,h,T){return t("list.map"),O(x,h,T)},c.list.index=1,c.obj=c.boj||{is:function(x){return t("obj"),x?x instanceof Object&&x.constructor===Object||Object.prototype.toString.call(x).match(/^\[object (\w+)\]$/)[1]==="Object":!1}},c.obj.put=c.obj.put||function(x,h,T){return t("obj.put"),(x||{})[h]=T,x},c.obj.has=c.obj.has||function(x,h){return t("obj.has"),x&&Object.prototype.hasOwnProperty.call(x,h)},c.obj.del=c.obj.del||function(x,h){if(t("obj.del"),!!x)return x[h]=null,delete x[h],x},c.obj.as=c.obj.as||function(x,h,T,E){return t("obj.as"),x[h]=x[h]||(E===T?{}:T)},c.obj.ify=c.obj.ify||function(x){if(t("obj.ify"),y(x))return x;try{x=JSON.parse(x)}catch{x={}}return x},function(){var x;function h(T,E){A(this,E)&&x!==this[E]||(this[E]=T)}c.obj.to=c.obj.to||function(T,E){return t("obj.to"),E=E||{},O(T,h,E),E}}(),c.obj.copy=c.obj.copy||function(x){return t("obj.copy"),x&&JSON.parse(JSON.stringify(x))},function(){function x(h,T){var E=this.n,B;if(!(E&&(T===E||y(E)&&A(E,T)))&&B!==T)return!0}c.obj.empty=c.obj.empty||function(h,T){return t("obj.empty"),h?!O(h,x,{n:T}):!0}}(),function(){function x(E,B){if(arguments.length===2){x.r=x.r||{},x.r[E]=B;return}x.r=x.r||[],x.r.push(E)}var h=Object.keys,T;Object.keys=Object.keys||function(E){return T(E,function(B,N,D){D(N)})},c.obj.map=T=c.obj.map||function(E,B,N){t("obj.map");var D,G=0,I,U,R,P,L=typeof B=="function";if(x.r=D,h&&y(E)&&(R=h(E),P=!0),N=N||{},g(E)||R)for(I=(R||E).length;G<I;G++){var H=G+c.list.index;if(L){if(U=P?B.call(N,E[R[G]],R[G],x):B.call(N,E[G],H,x),U!==D)return U}else if(B===E[P?R[G]:G])return R?R[G]:H}else for(G in E)if(L){if(A(E,G)&&(U=N?B.call(N,E[G],G,x):B(E[G],G,x),U!==D))return U}else if(B===E[G])return G;return L?x.r:c.list.index?0:-1}}(),c.time=c.time||{},c.time.is=c.time.is||function(x){return t("time"),x?x instanceof Date:+new Date().getTime()};var l=c.fn.is,g=c.list.is,i=c.obj,y=i.is,A=i.has,O=i.map,e={};e.is=function(x){return t("val.is"),x===$?!1:x===null?!0:x===1/0?!1:d(x)||s(x)||o(x)?!0:e.link.is(x)||!1},e.link=e.rel={_:"#"},function(){e.link.is=function(h){if(t("val.link.is"),h&&h[r]&&!h._&&y(h)){var T={};if(O(h,x,T),T.id)return T.id}return!1};function x(h,T){var E=this;if(E.id)return E.id=!1;if(T==r&&d(h))E.id=h;else return E.id=!1}}(),e.link.ify=function(x){return t("val.link.ify"),j({},r,x)},c.obj.has._=".";var r=e.link._,$,s=c.bi.is,o=c.num.is,d=c.text.is,i=c.obj,y=i.is,j=i.put,O=i.map;c.val=c.val||e;var p={_:"_"};p.soul=function(x,h){return t("node.soul"),x&&x._&&x._[h||f]},p.soul.ify=function(x,h){return t("node.soul.ify"),h=typeof h=="string"?{soul:h}:h||{},x=x||{},x._=x._||{},x._[f]=h.soul||x._[f]||a(),x},p.soul._=e.link._,function(){p.is=function(h,T,E){t("node.is");var B;return y(h)&&(B=p.soul(h))?!O(h,x,{as:E,cb:T,s:B,n:h}):!1};function x(h,T){if(T!==p._){if(!e.is(h))return!0;this.cb&&this.cb.call(this.as,h,T,this.n,this.s)}}}(),function(){p.ify=function(h,T,E){return t("node.ify"),T?typeof T=="string"?T={soul:T}:typeof T=="function"&&(T={map:T}):T={},T.map&&(T.node=T.map.call(E,h,$,T.node||{})),(T.node=p.soul.ify(T.node||{},T))&&O(h,x,{o:T,as:E}),T.node};function x(h,T){var E=this.o,B,N;if(E.map){B=E.map.call(this.as,h,""+T,E.node),N===B?w(E.node,T):E.node&&(E.node[T]=B);return}e.is(h)&&(E.node[T]=h)}}();var i=c.obj,y=i.is,w=i.del,O=i.map,u=c.text,a=u.random,f=p.soul._,$;c.node=c.node||p;var v=c.state;v.lex=function(){return t("state.lex"),v().toString(36).replace(".","")},v.to=function(x,h,T){t("state.to");var E=(x||{})[h];return y(E)&&(E=C(E)),v.ify(T,h,v.is(x,h),E,p.soul(x))},function(){v.map=function(h,T,E){t("state.map");var B,N=y(N=h||T)?N:null;return h=l(h=h||T)?h:null,N&&!h?(T=o(T)?T:v(),N[_]=N[_]||{},O(N,x,{o:N,s:T}),N):(E=E||y(T)?T:B,T=o(T)?T:v(),function(D,G,I,U){if(!h)return x.call({o:I,s:T},D,G),D;h.call(E||this||{},D,G,I,U),!(A(I,G)&&B===I[G])&&x.call({o:I,s:T},D,G)})};function x(h,T){_!==T&&v.ify(this.o,T,this.s)}}();var i=c.obj;i.as;var A=i.has,y=i.is,O=i.map,C=i.copy,k=c.num,o=k.is,b=c.fn,l=b.is,_=p._,$,m={};(function(){m.is=function(T,E,B,N){return t("graph.is"),!T||!y(T)||S(T)?!1:!O(T,x,{cb:E,fn:B,as:N})};function x(T,E){if(!T||E!==p.soul(T)||!p.is(T,this.fn,this.as))return!0;this.cb&&(h.n=T,h.as=this.as,this.cb.call(h.as,T,E,h))}function h(T){T&&p.is(h.n,T,h.as)}})(),function(){m.ify=function(N,D,G){t("graph.ify");var I={path:[],obj:N};return D?typeof D=="string"?D={soul:D}:typeof D=="function"&&(D.map=D):D={},typeof G=="string"&&(D.soul=D.soul||G,G=$),D.soul&&(I.link=e.link.ify(D.soul)),D.shell=(G||{}).shell,D.graph=D.graph||{},D.seen=D.seen||[],D.as=D.as||G,x(D,I),D.root=I.node,D.graph};function x(N,D){var G;return(G=B(N,D))?G:(D.env=N,D.soul=T,p.ify(D.obj,h,D)&&(D.link=D.link||e.link.ify(p.soul(D.node)),D.obj!==N.shell&&(N.graph[e.link.is(D.link)]=D.node)),D)}function h(N,D,G){var I=this,U=I.env,R,P;if(p._===D&&A(N,e.link._))return G._;if(R=E(N,D,G,I,U)){if(D||(I.node=I.node||G||{},A(N,p._)&&p.soul(N)&&(I.node._=C(N._)),I.node=p.soul.ify(I.node,e.link.is(I.link)),I.link=I.link||e.link.ify(p.soul(I.node))),(P=U.map)&&(P.call(U.as||{},N,D,G,I),A(G,D))){if(N=G[D],$===N){w(G,D);return}if(!(R=E(N,D,G,I,U)))return}if(!D)return I.node;if(R===!0)return N;if(P=x(U,{obj:N,path:I.path.concat(D)}),!!P.node)return P.link}}function T(N){var D=this,G=e.link.is(D.link),I=D.env.graph;D.link=D.link||e.link.ify(N),D.link[e.link._]=N,D.node&&D.node[p._]&&(D.node[p._][e.link._]=N),A(I,G)&&(I[N]=I[G],w(I,G))}function E(N,D,G,I,U){var R;if(e.is(N))return!0;if(y(N))return 1;if(R=U.invalid)return N=R.call(U.as||{},N,D,G),E(N,D,G,I,U);U.err="Invalid value at '"+I.path.concat(D).join(".")+"'!",c.list.is(N)&&(U.err+=" Use `.set(item)` instead of an Array.")}function B(N,D){for(var G=N.seen,I=G.length,U;I--;)if(U=G[I],D.obj===U.obj)return U;G.push(D)}}(),m.node=function(x){t("graph.node");var h=p.soul(x);if(h)return j({},h,x)},function(){m.to=function(h,T,E){if(t("graph.to"),!!h){var B={};return E=E||{seen:{}},O(h[T],x,{obj:B,graph:h,opt:E}),B}};function x(h,T){var E,B;if(p._===T){if(S(h,e.link._))return;this.obj[T]=C(h);return}if(!(E=e.link.is(h))){this.obj[T]=h;return}if(B=this.opt.seen[E]){this.obj[T]=B;return}this.obj[T]=this.opt.seen[E]=m.to(this.graph,E,this.opt)}}();var l=c.fn.is,i=c.obj,y=i.is,w=i.del,A=i.has,S=i.empty,j=i.put,O=i.map,C=i.copy,$;c.graph=c.graph||m}}()}(ee)),ee.exports}var ke,fn;function di(){return fn||(fn=1,ke=He()),ke}var yi=di();const wi=Ke(yi);var ne={exports:{}};ne.exports;var sn;function _i(){return sn||(sn=1,function(n){(function(){function t(g,e){return e?Zn(g):g.slice?t[r(g)]:function(s,d){g(s={exports:{}}),t[r(d)]=s.exports};function r(s){return s.split("/").slice(-1).toString().replace(".js","")}}var c=n;t(function(g){typeof self<"u"&&(g.window=self),typeof window<"u"&&(g.window=window);var e=g.window||g,r,s=e.SEA||{};(s.window=g.window)&&(s.window.SEA=s);try{r+""!=typeof c&&(c.exports=s)}catch{}g.exports=s})(t,"./root"),t(function(g){var e=t("./root");try{e.window&&location.protocol.indexOf("s")<0&&location.host.indexOf("localhost")<0&&!/^127\.\d+\.\d+\.\d+$/.test(location.hostname)&&location.protocol.indexOf("file:")<0&&(console.warn("HTTPS needed for WebCrypto in SEA, redirecting..."),location.protocol="https:")}catch{}})(t,"./https"),t(function(g){var e;if(e+""==typeof btoa){if(e+""==typeof Buffer)try{Tt.Buffer=t("buffer",1).Buffer}catch{console.log("Please `npm install buffer` or add it to your package.json !")}Tt.btoa=function(r){return Buffer.from(r,"binary").toString("base64")},Tt.atob=function(r){return Buffer.from(r,"base64").toString("binary")}}})(t,"./base64"),t(function(g){t("./base64");function e(){}Object.assign(e,{from:Array.from}),e.prototype=Object.create(Array.prototype),e.prototype.toString=function(r,s,d){r=r||"utf8",s=s||0;const p=this.length;if(r==="hex"){const u=new Uint8Array(this);return[...Array((d&&d+1||p)-s).keys()].map(a=>u[a+s].toString(16).padStart(2,"0")).join("")}if(r==="utf8")return Array.from({length:(d||p)-s},(u,a)=>String.fromCharCode(this[a+s])).join("");if(r==="base64")return btoa(this)},g.exports=e})(t,"./array"),t(function(g){t("./base64");var e=t("./array");function r(...s){return console.warn("new SafeBuffer() is depreciated, please use SafeBuffer.from()"),r.from(...s)}r.prototype=Object.create(Array.prototype),Object.assign(r,{from(){if(!Object.keys(arguments).length||arguments[0]==null)throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");const s=arguments[0];let d;if(typeof s=="string"){const u=arguments[1]||"utf8";if(u==="hex"){const a=s.match(/([\da-fA-F]{2})/g).map(f=>parseInt(f,16));if(!a||!a.length)throw new TypeError("Invalid first argument for type 'hex'.");d=e.from(a)}else if(u==="utf8"||u==="binary"){const a=s.length,f=new Uint16Array(a);Array.from({length:a},(v,k)=>f[k]=s.charCodeAt(k)),d=e.from(f)}else if(u==="base64"){const a=atob(s),f=a.length,v=new Uint8Array(f);Array.from({length:f},(k,o)=>v[o]=a.charCodeAt(o)),d=e.from(v)}else u==="binary"?d=e.from(s):console.info("SafeBuffer.from unknown encoding: "+u);return d}if(s.byteLength,s.byteLength?s.byteLength:s.length){let u;return s instanceof ArrayBuffer&&(u=new Uint8Array(s)),e.from(u||s)}},alloc(s,d=0){return e.from(new Uint8Array(Array.from({length:s},()=>d)))},allocUnsafe(s){return e.from(new Uint8Array(Array.from({length:s})))},concat(s){if(!Array.isArray(s))throw new TypeError("First argument must be Array containing ArrayBuffer or Uint8Array instances.");return e.from(s.reduce((d,p)=>d.concat(Array.from(p)),[]))}}),r.prototype.from=r.from,r.prototype.toString=e.prototype.toString,g.exports=r})(t,"./buffer"),t(function(g){const e=t("./root"),r={Buffer:t("./buffer")};var s={},d;if(JSON.parseAsync=JSON.parseAsync||function(u,a,f){var v;try{a(v,JSON.parse(u,f))}catch(k){a(k)}},JSON.stringifyAsync=JSON.stringifyAsync||function(u,a,f,v){var k;try{a(k,JSON.stringify(u,f,v))}catch(o){a(o)}},r.parse=function(u,a){return new Promise(function(f,v){JSON.parseAsync(u,function(k,o){k?v(k):f(o)},a)})},r.stringify=function(u,a,f){return new Promise(function(v,k){JSON.stringifyAsync(u,function(o,b){o?k(o):v(b)},a,f)})},e.window&&(r.crypto=e.window.crypto||e.window.msCrypto,r.subtle=(r.crypto||s).subtle||(r.crypto||s).webkitSubtle,r.TextEncoder=e.window.TextEncoder,r.TextDecoder=e.window.TextDecoder,r.random=u=>r.Buffer.from(r.crypto.getRandomValues(new Uint8Array(r.Buffer.alloc(u))))),!r.TextDecoder){const{TextEncoder:u,TextDecoder:a}=t((d+""==typeof c?".":"")+"./lib/text-encoding",1);r.TextDecoder=a,r.TextEncoder=u}if(!r.crypto)try{var p=t("crypto",1);Object.assign(r,{crypto:p,random:a=>r.Buffer.from(p.randomBytes(a))});const{Crypto:u}=t("@peculiar/webcrypto",1);r.ossl=r.subtle=new u({directory:"ossl"}).subtle}catch{console.log("Please `npm install @peculiar/webcrypto` or add it to your package.json !")}g.exports=r})(t,"./shim"),t(function(g){var e=t("./root"),r=t("./shim"),s={};s.pbkdf2={hash:{name:"SHA-256"},iter:1e5,ks:64},s.ecdsa={pair:{name:"ECDSA",namedCurve:"P-256"},sign:{name:"ECDSA",hash:{name:"SHA-256"}}},s.ecdh={name:"ECDH",namedCurve:"P-256"},s.jwk=function(d,p){d=d.split(".");var u=d[0],a=d[1],f={kty:"EC",crv:"P-256",x:u,y:a,ext:!0};return f.key_ops=p?["sign"]:["verify"],p&&(f.d=p),f},s.keyToJwk=function(d){return{kty:"oct",k:d.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""),ext:!1,alg:"A256GCM"}},s.recall={validity:12*60*60,hook:function(d){return d}},s.check=function(d){return typeof d=="string"&&d.slice(0,4)==="SEA{"},s.parse=async function(p){try{var u=typeof p=="string";return u&&p.slice(0,4)==="SEA{"&&(p=p.slice(3)),u?await r.parse(p):p}catch{}return p},e.opt=s,g.exports=s})(t,"./settings"),t(function(g){var e=t("./shim");g.exports=async function(r,s){var d=typeof r=="string"?r:await e.stringify(r),p=await e.subtle.digest({name:s||"SHA-256"},new e.TextEncoder().encode(d));return e.Buffer.from(p)}})(t,"./sha256"),t(function(g){const e=t("./shim"),r=e.subtle,s=e.ossl?e.ossl:r,d=p=>s.digest({name:"SHA-1"},new ArrayBuffer(p));g.exports=d})(t,"./sha1"),t(function(g){var e=t("./root"),r=t("./shim"),s=t("./settings"),d=t("./sha256"),p;e.work=e.work||(async(u,a,f,v)=>{try{var k=(a||{}).epub||a;if(v=v||{},k instanceof Function&&(f=k,k=p),u=typeof u=="string"?u:await r.stringify(u),(v.name||"").toLowerCase().slice(0,3)==="sha"){var o=r.Buffer.from(await d(u,v.name),"binary").toString(v.encode||"base64");if(f)try{f(o)}catch(l){console.log(l)}return o}k=k||r.random(9);var b=await(r.ossl||r.subtle).importKey("raw",new r.TextEncoder().encode(u),{name:v.name||"PBKDF2"},!1,["deriveBits"]),_=await(r.ossl||r.subtle).deriveBits({name:v.name||"PBKDF2",iterations:v.iterations||s.pbkdf2.iter,salt:new r.TextEncoder().encode(v.salt||k),hash:v.hash||s.pbkdf2.hash},b,v.length||s.pbkdf2.ks*8);u=r.random(u.length);var m=r.Buffer.from(_,"binary").toString(v.encode||"base64");if(f)try{f(m)}catch(l){console.log(l)}return m}catch(l){if(console.log(l),e.err=l,e.throw)throw l;f&&f();return}}),g.exports=e.work})(t,"./work"),t(function(g){var e=t("./root"),r=t("./shim");t("./settings"),e.name=e.name||(async(s,d)=>{try{if(s)try{s()}catch(p){console.log(p)}return}catch(p){if(console.log(p),e.err=p,e.throw)throw p;s&&s();return}}),e.pair=e.pair||(async(s,d)=>{try{var p=r.ossl||r.subtle,u=await r.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]).then(async v=>{var k={};k.priv=(await r.subtle.exportKey("jwk",v.privateKey)).d;var o=await r.subtle.exportKey("jwk",v.publicKey);return k.pub=o.x+"."+o.y,k});try{var a=await p.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]).then(async v=>{var k={};k.epriv=(await p.exportKey("jwk",v.privateKey)).d;var o=await p.exportKey("jwk",v.publicKey);return k.epub=o.x+"."+o.y,k})}catch(v){if(e.window)throw v;if(v=="Error: ECDH is not a supported algorithm")console.log("Ignoring ECDH...");else throw v}a=a||{};var f={pub:u.pub,priv:u.priv,epub:a.epub,epriv:a.epriv};if(s)try{s(f)}catch(v){console.log(v)}return f}catch(v){if(console.log(v),e.err=v,e.throw)throw v;s&&s();return}}),g.exports=e.pair})(t,"./pair"),t(function(g){var e=t("./root"),r=t("./shim"),s=t("./settings"),d=t("./sha256"),p;e.sign=e.sign||(async(u,a,f,v)=>{try{if(v=v||{},!(a||v).priv){if(!e.I)throw"No signing key.";a=await e.I(null,{what:u,how:"sign",why:v.why})}if(p===u)throw"`undefined` not allowed.";var k=await s.parse(u),o=v.check=v.check||k;if(e.verify&&(e.opt.check(o)||o&&o.s&&o.m)&&p!==await e.verify(o,a)){var y=await s.parse(o);if(v.raw||(y="SEA"+await r.stringify(y)),f)try{f(y)}catch(A){console.log(A)}return y}var b=a.pub,_=a.priv,m=s.jwk(b,_),l=await d(k),i=await(r.ossl||r.subtle).importKey("jwk",m,{name:"ECDSA",namedCurve:"P-256"},!1,["sign"]).then(w=>(r.ossl||r.subtle).sign({name:"ECDSA",hash:{name:"SHA-256"}},w,new Uint8Array(l))),y={m:k,s:r.Buffer.from(i,"binary").toString(v.encode||"base64")};if(v.raw||(y="SEA"+await r.stringify(y)),f)try{f(y)}catch(w){console.log(w)}return y}catch(w){if(console.log(w),e.err=w,e.throw)throw w;f&&f();return}}),g.exports=e.sign})(t,"./sign"),t(function(g){var e=t("./root"),r=t("./shim"),s=t("./settings"),d=t("./sha256"),p;e.verify=e.verify||(async(f,v,k,o)=>{try{var b=await s.parse(f);if(v===!1){var _=await s.parse(b.m);if(k)try{k(_)}catch(O){console.log(O)}return _}o=o||{};var m=v.pub||v,l=e.opt.slow_leak?await e.opt.slow_leak(m):await(r.ossl||r.subtle).importKey("jwk",s.jwk(m),{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),i=await d(b.m),y,w,A,S;try{if(y=r.Buffer.from(b.s,o.encode||"base64"),w=new Uint8Array(y),A=await(r.ossl||r.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},l,w,new Uint8Array(i)),!A)throw"Signature did not match."}catch{if(e.opt.fallback)return await e.opt.fall_verify(f,v,k,o)}var j=A?await s.parse(b.m):p;if(k)try{k(j)}catch(O){console.log(O)}return j}catch(O){if(console.log(O),e.err=O,e.throw)throw O;k&&k();return}}),g.exports=e.verify;var u={};e.opt.slow_leak=f=>{if(u[f])return u[f];var v=s.jwk(f);return u[f]=(r.ossl||r.subtle).importKey("jwk",v,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),u[f]};var a=e.opt;e.opt.fall_verify=async function(f,v,k,o,b){if(b===e.opt.fallback)throw"Signature did not match";b=b||1;var _=f||"";f=e.opt.unpack(f)||f;var m=await s.parse(f),l=v.pub||v,i=await e.opt.slow_leak(l),y=b<=e.opt.fallback?r.Buffer.from(await r.subtle.digest({name:"SHA-256"},new r.TextEncoder().encode(await s.parse(m.m)))):await d(m.m),w,A,S;try{if(w=r.Buffer.from(m.s,o.encode||"base64"),A=new Uint8Array(w),S=await(r.ossl||r.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},i,A,new Uint8Array(y)),!S)throw"Signature did not match."}catch{try{w=r.Buffer.from(m.s,"utf8"),A=new Uint8Array(w),S=await(r.ossl||r.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},i,A,new Uint8Array(y))}catch{if(!S)throw"Signature did not match."}}var j=S?await s.parse(m.m):p;if(a.fall_soul=_["#"],a.fall_key=_["."],a.fall_val=f,a.fall_state=_[">"],k)try{k(j)}catch(O){console.log(O)}return j},e.opt.fallback=2})(t,"./verify"),t(function(g){var e=t("./shim"),r=t("./settings"),s=t("./sha256");const d=async(p,u,a)=>{const f=p+(u||e.random(8)).toString("utf8"),v=e.Buffer.from(await s(f),"binary"),k=r.keyToJwk(v);return await e.subtle.importKey("jwk",k,{name:"AES-GCM"},!1,["encrypt","decrypt"])};g.exports=d})(t,"./aeskey"),t(function(g){var e=t("./root"),r=t("./shim");t("./settings");var s=t("./aeskey"),d;e.encrypt=e.encrypt||(async(p,u,a,f)=>{try{f=f||{};var v=(u||f).epriv||u;if(d===p)throw"`undefined` not allowed.";if(!v){if(!e.I)throw"No encryption key.";u=await e.I(null,{what:p,how:"encrypt",why:f.why}),v=u.epriv||u}var k=typeof p=="string"?p:await r.stringify(p),o={s:r.random(9),iv:r.random(15)},b=await s(v,o.s,f).then(m=>r.subtle.encrypt({name:f.name||"AES-GCM",iv:new Uint8Array(o.iv)},m,new r.TextEncoder().encode(k))),_={ct:r.Buffer.from(b,"binary").toString(f.encode||"base64"),iv:o.iv.toString(f.encode||"base64"),s:o.s.toString(f.encode||"base64")};if(f.raw||(_="SEA"+await r.stringify(_)),a)try{a(_)}catch(m){console.log(m)}return _}catch(m){if(console.log(m),e.err=m,e.throw)throw m;a&&a();return}}),g.exports=e.encrypt})(t,"./encrypt"),t(function(g){var e=t("./root"),r=t("./shim"),s=t("./settings"),d=t("./aeskey");e.decrypt=e.decrypt||(async(p,u,a,f)=>{try{f=f||{};var v=(u||f).epriv||u;if(!v){if(!e.I)throw"No decryption key.";u=await e.I(null,{what:p,how:"decrypt",why:f.why}),v=u.epriv||u}var k=await s.parse(p),o,b,_;try{o=r.Buffer.from(k.s,f.encode||"base64"),b=r.Buffer.from(k.iv,f.encode||"base64"),_=r.Buffer.from(k.ct,f.encode||"base64");var m=await d(v,o,f).then(i=>r.subtle.decrypt({name:f.name||"AES-GCM",iv:new Uint8Array(b),tagLength:128},i,new Uint8Array(_)))}catch{if(f.encode==="utf8")throw"Could not decrypt";if(e.opt.fallback)return f.encode="utf8",await e.decrypt(p,u,a,f)}var l=await s.parse(new r.TextDecoder("utf8").decode(m));if(a)try{a(l)}catch(i){console.log(i)}return l}catch(i){if(console.log(i),e.err=i,e.throw)throw i;a&&a();return}}),g.exports=e.decrypt})(t,"./decrypt"),t(function(g){var e=t("./root"),r=t("./shim");t("./settings"),e.secret=e.secret||(async(d,p,u,a)=>{try{if(a=a||{},!p||!p.epriv||!p.epub){if(!e.I)throw"No secret mix.";p=await e.I(null,{what:d,how:"secret",why:a.why})}var f=d.epub||d,v=p.epub,k=p.epriv,o=r.ossl||r.subtle,b=s(f),_=Object.assign({public:await o.importKey(...b,!0,[])},{name:"ECDH",namedCurve:"P-256"}),m=s(v,k),l=await o.importKey(...m,!1,["deriveBits"]).then(async y=>{var w=await o.deriveBits(_,y,256),A=new Uint8Array(w),S=await o.importKey("raw",A,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);return o.exportKey("jwk",S).then(({k:j})=>j)}),i=l;if(u)try{u(i)}catch(y){console.log(y)}return i}catch(y){if(console.log(y),e.err=y,e.throw)throw y;u&&u();return}});var s=(d,p)=>{var[u,a]=d.split("."),f=p?{d:p}:{};return["jwk",Object.assign(f,{x:u,y:a,kty:"EC",crv:"P-256",ext:!0}),{name:"ECDH",namedCurve:"P-256"}]};g.exports=e.secret})(t,"./secret"),t(function(g){var e=t("./root");e.certify=e.certify||(async(r,s={},d,p,u={})=>{try{if(console.log("SEA.certify() is an early experimental community supported method that may change API behavior without warning in any future version."),r=(()=>{var i=[];if(r){if((typeof r=="string"||Array.isArray(r))&&r.indexOf("*")>-1)return"*";if(typeof r=="string")return r;if(Array.isArray(r)){if(r.length===1&&r[0])return typeof r[0]=="object"&&r[0].pub?r[0].pub:typeof r[0]=="string"?r[0]:null;r.map(y=>{typeof y=="string"?i.push(y):typeof y=="object"&&y.pub&&i.push(y.pub)})}return typeof r=="object"&&r.pub?r.pub:i.length>0?i:null}})(),!r)return console.log("No certificant found.");const f=u.expiry&&(typeof u.expiry=="number"||typeof u.expiry=="string")?parseFloat(u.expiry):null,v=(s||{}).read?s.read:null,k=(s||{}).write?s.write:typeof s=="string"||Array.isArray(s)||s["+"]||s["#"]||s["."]||s["="]||s["*"]||s[">"]||s["<"]?s:null,o=(u||{}).block||(u||{}).blacklist||(u||{}).ban||{},b=o.read&&(typeof o.read=="string"||(o.read||{})["#"])?o.read:null,_=typeof o=="string"?o:o.write&&(typeof o.write=="string"||o.write["#"])?o.write:null;if(!v&&!k)return console.log("No policy found.");const m=JSON.stringify({c:r,...f?{e:f}:{},...v?{r:v}:{},...k?{w:k}:{},...b?{rb:b}:{},..._?{wb:_}:{}});var a=await e.sign(m,d,null,{raw:1});if(u.raw||(a="SEA"+JSON.stringify(a)),p)try{p(a)}catch(i){console.log(i)}return a}catch(f){if(e.err=f,e.throw)throw f;p&&p();return}}),g.exports=e.certify})(t,"./certify"),t(function(g){var e=t("./shim"),r=t("./root");r.work=t("./work"),r.sign=t("./sign"),r.verify=t("./verify"),r.encrypt=t("./encrypt"),r.decrypt=t("./decrypt"),r.certify=t("./certify"),r.random=r.random||e.random,r.Buffer=r.Buffer||t("./buffer"),r.keyid=r.keyid||(async s=>{try{const d=e.Buffer.concat(s.replace(/-/g,"+").replace(/_/g,"/").split(".").map(f=>e.Buffer.from(f,"base64"))),p=e.Buffer.concat([e.Buffer.from([153,d.length/256,d.length%256]),d]),u=await sha1hash(p),a=e.Buffer.from(u,"binary");return a.toString("hex",a.length-8)}catch(d){throw console.log(d),d}}),((r.window||{}).GUN||{}).SEA=r,g.exports=r})(t,"./sea"),t(function(g){var e=t("./sea"),r,s;e.window?r=e.window.GUN||{chain:{}}:r=t((s+""==typeof c?".":"")+"./gun",1),e.GUN=r;function d(u){this._={$:this}}d.prototype=function(){function u(){}return u.prototype=r.chain,new u}(),d.prototype.constructor=d,r.chain.user=function(u){var a=this,v=a.back(-1),f;if(u)return u=e.opt.pub((u._||"")["#"])||u,v.get("~"+u);if(f=v.back("user"))return f;var v=v._,k=v,o=k.opt.uuid||p;return(k=(f=k.user=a.chain(new d))._).opt={},k.opt.uuid=function(b){var _=o(),m=v.user;return!m||!(m=m.is)||!(m=m.pub)||(_="~"+m+"/"+_,b&&b.call&&b(null,_)),_},f};function p(){return r.state().toString(36).replace(".","")}r.User=d,d.GUN=r,d.SEA=r.SEA=e,g.exports=d})(t,"./user"),t(function(g){var e,r=""+e!=typeof GUN?GUN||{chain:{}}:t((""+e==typeof c?".":"")+"./gun",1);r.chain.then=function(s,d){var p=this,u=new Promise(function(a,f){p.once(a,d)});return s?u.then(s):u}})(t,"./then"),t(function(g){var e=t("./user"),r=e.SEA,s=e.GUN,d=function(){};e.prototype.create=function(...p){var u=typeof p[0]=="object"&&(p[0].pub||p[0].epub)?p[0]:typeof p[1]=="object"&&(p[1].pub||p[1].epub)?p[1]:null,a=u&&(u.pub||u.epub)?u.pub:typeof p[0]=="string"?p[0]:null,f=u&&(u.pub||u.epub)?u:a&&typeof p[1]=="string"?p[1]:null,v=p.filter(i=>typeof i=="function")[0]||null,k=p&&p.length>1&&typeof p[p.length-1]=="object"?p[p.length-1]:{},o=this,b=o._,_=o.back(-1);if(v=v||d,k=k||{},k.check!==!1){var m;if(a||(m="No user."),(f||"").length<8&&(m="Password too short!"),m)return v({err:s.log(m)}),o}if(b.ing)return(v||d)({err:s.log("User is already being created or authenticated!"),wait:!0}),o;b.ing=!0;var l={};return l.a=function(i){if(l.pubs=i,i&&!k.already){var y={err:s.log("User already created!")};b.ing=!1,(v||d)(y),o.leave();return}l.salt=String.random(64),r.work(f,l.salt,l.b)},l.b=function(i){l.proof=i,u?l.c(u):r.pair(l.c)},l.c=function(i){var y;l.pair=i||{},(y=b.root.user)&&(y._.sea=i,y.is={pub:i.pub,epub:i.epub,alias:a}),l.data={pub:i.pub},l.d()},l.d=function(){l.data.alias=a,l.e()},l.e=function(){l.data.epub=l.pair.epub,r.encrypt({priv:l.pair.priv,epriv:l.pair.epriv},l.proof,l.f,{raw:1})},l.f=function(i){l.data.auth=JSON.stringify({ek:i,s:l.salt}),l.g(l.data.auth)},l.g=function(i){var y;l.data.auth=l.data.auth||i,_.get(y="~"+l.pair.pub).put(l.data).on(l.h);var w={};w[y]={"#":y},_.get("~@"+a).put(w).get(y).on(l.i)},l.h=function(i,y,w,A){A.off(),l.h.ok=1,l.i()},l.i=function(i,y,w,A){A&&(l.i.ok=1,A.off()),!(!l.h.ok||!l.i.ok)&&(b.ing=!1,v({ok:0,pub:l.pair.pub}),d===v&&(u?o.auth(u):o.auth(a,f)))},_.get("~@"+a).once(l.a),o},e.prototype.leave=function(p,u){var a=this,f=a.back(-1)._.user;if(f&&(delete f.is,delete f._.is,delete f._.sea),r.window)try{var v={};v=r.window.sessionStorage,delete v.recall,delete v.pair}catch{}return a}})(t,"./create"),t(function(g){var e=t("./user"),r=e.SEA,s=e.GUN,d=function(){};e.prototype.auth=function(...u){var a=typeof u[0]=="object"&&(u[0].pub||u[0].epub)?u[0]:typeof u[1]=="object"&&(u[1].pub||u[1].epub)?u[1]:null,f=!a&&typeof u[0]=="string"?u[0]:null,v=(f||a&&!(a.priv&&a.epriv))&&typeof u[1]=="string"?u[1]:null,k=u.filter(w=>typeof w=="function")[0]||null,o=u&&u.length>1&&typeof u[u.length-1]=="object"?u[u.length-1]:{},b=this,_=b._,m=b.back(-1);if(_.ing)return(k||d)({err:s.log("User is already being created or authenticated!"),wait:!0}),b;_.ing=!0;var l={},i,y=9;return l.a=function(w){if(!w)return l.b();if(!w.pub){var A=[];return Object.keys(w).forEach(function(S){S!="_"&&A.push(w[S])}),l.b(A)}if(l.name)return l.f(w);l.c((l.data=w).auth)},l.b=function(w){var A=(l.list=(l.list||[]).concat(w||[])).shift();if(i===A){if(l.name)return l.err("Your user account is not published for dApps to access, please consider syncing it online, or allowing local access by adding your device as a peer.");if(f&&y--){m.get("~@"+f).once(l.a);return}return l.err("Wrong user or password.")}m.get(A).once(l.a)},l.c=function(w){if(i===w)return l.b();if(typeof w=="string")return l.c(p(w));r.work(v,(l.auth=w).s,l.d,l.enc)},l.d=function(w){r.decrypt(l.auth.ek,w,l.e,l.enc)},l.e=function(w){if(i===w)return l.enc?(l.enc=null,l.b()):(l.enc={encode:"utf8"},l.c(l.auth));l.half=w,l.f(l.data)},l.f=function(w){var A=l.half||{},S=l.data||{};l.g(l.lol={pub:w.pub||S.pub,epub:w.epub||S.epub,priv:w.priv||A.priv,epriv:w.epriv||A.epriv})},l.g=function(w){if(!w||!w.pub||!w.epub)return l.b();l.pair=w;var A=m._.user,S=A._;S.tag;var j=S.opt;S=A._=m.get("~"+w.pub)._,S.opt=j,A.is={pub:w.pub,epub:w.epub,alias:f||w.pub},S.sea=l.pair,_.ing=!1;try{v&&i==(p(_.root.graph["~"+w.pub].auth)||"")[":"]&&(o.shuffle=o.change=v)}catch{}if(o.change?l.z():(k||d)(S),r.window&&(b.back("user")._.opt||o).remember)try{var O={};O=r.window.sessionStorage,O.recall=!0,O.pair=JSON.stringify(w)}catch{}try{m._.tag.auth?m._.on("auth",S):setTimeout(function(){m._.on("auth",S)},1)}catch(C){s.log("Your 'auth' callback crashed with:",C)}},l.h=function(w){if(!w)return l.b();if(f=w.alias,f||(f=w.alias="~"+a.pub),!w.auth)return l.g(a);a=null,l.c((l.data=w).auth)},l.z=function(){l.salt=String.random(64),r.work(o.change,l.salt,l.y)},l.y=function(w){r.encrypt({priv:l.pair.priv,epriv:l.pair.epriv},w,l.x,{raw:1})},l.x=function(w){l.w(JSON.stringify({ek:w,s:l.salt}))},l.w=function(w){if(o.shuffle){console.log("migrate core account from UTF8 & shuffle");var A={};Object.keys(l.data).forEach(function(S){A[S]=l.data[S]}),delete A._,A.auth=w,m.get("~"+l.pair.pub).put(A)}m.get("~"+l.pair.pub).get("auth").put(w,k||d)},l.err=function(w){var A={err:s.log(w||"User cannot be found!")};_.ing=!1,(k||d)(A)},l.plugin=function(w){if(!(l.name=w))return l.err();var A=[w];w[0]!=="~"&&(A[1]="~"+w,A[2]="~@"+w),l.b(A)},a?a.priv&&a.epriv?l.g(a):m.get("~"+a.pub).once(l.h):f?m.get("~@"+f).once(l.a):!f&&!v&&r.name(l.plugin),b};function p(u){if(typeof u!="string")return u;try{u=JSON.parse(u)}catch{u={}}return u}})(t,"./auth"),t(function(g){var e=t("./user"),r=e.SEA;e.GUN,e.prototype.recall=function(s,d){var p=this,u=p.back(-1);if(s=s||{},s&&s.sessionStorage){if(r.window)try{var a={};a=r.window.sessionStorage,a&&(u._.opt.remember=!0,(p.back("user")._.opt||s).remember=!0,(a.recall||a.pair)&&u.user().auth(JSON.parse(a.pair),d))}catch{}return p}return p}})(t,"./recall"),t(function(g){var e=t("./user"),r=e.SEA,s=e.GUN,d=function(){};e.prototype.pair=function(){var p=this,u;try{u=new Proxy({DANGER:"☠"},{get:function(a,f,v){if(!(!p.is||!(p._||"").sea))return p._.sea[f]}})}catch{}return u},e.prototype.delete=async function(p,u,a){console.log("user.delete() IS DEPRECATED AND WILL BE MOVED TO A MODULE!!!");var f=this;f.back(-1);var v=f.back("user");try{v.auth(p,u,function(k){var o=(v.is||{}).pub;v.map().once(function(){this.put(null)}),v.leave(),(a||d)({ok:0})})}catch(k){s.log("User.delete failed! Error:",k)}return f},e.prototype.alive=async function(){console.log("user.alive() IS DEPRECATED!!!");const p=this.back(-1);try{return await authRecall(p),p._.user._}catch{const a="No session!";throw s.log(a),{err:a}}},e.prototype.trust=async function(p){console.log("`.trust` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!"),s.is(p)&&p.get("pub").get((u,a)=>{console.log(u,a)}),p.get("trust").get(path).put(theirPubkey)},e.prototype.grant=function(p,u){console.log("`.grant` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var a=this,f=a.back(-1).user(),v=f._.sea,k="";return a.back(function(o){o.is||(k+=o.get||"")}),async function(){var o,b=await f.get("grant").get(v.pub).get(k).then();b=await r.decrypt(b,v),b||(b=r.random(16).toString(),o=await r.encrypt(b,v),f.get("grant").get(v.pub).get(k).put(o));var _=p.get("pub").then(),m=p.get("epub").then();_=await _,m=await m;var l=await r.secret(m,v);o=await r.encrypt(b,l),f.get("grant").get(_).get(k).put(o,u)}(),a},e.prototype.secret=function(p,u){console.log("`.secret` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var a=this,f=a.back(-1).user(),v=f.pair(),k="";return a.back(function(o){o.is||(k+=o.get||"")}),async function(){var o,b=await f.get("trust").get(v.pub).get(k).then();b=await r.decrypt(b,v),b||(b=r.random(16).toString(),o=await r.encrypt(b,v),f.get("trust").get(v.pub).get(k).put(o)),o=await r.encrypt(p,b),a.put(o,u)}(),a},g.exports=e})(t,"./share"),t(function(g){var e=t("./sea"),r=t("./settings"),s,d=(e.window||"").GUN||t((""+s==typeof c?".":"")+"./gun",1);d.on("opt",function(o){o.sea||(o.sea={own:{}},o.on("put",p,o)),this.to.next(o)});function p(o){var b=this,_=b.as,m=o.put,l=m["#"],i=m["."],y=m[":"],w=m[">"],A=o["#"],S;if(!(!l||!i)){if((o._||"").faith&&(_.opt||"").faith&&typeof o._=="function"){e.opt.pack(m,function(O){e.verify(O,!1,function(C){m["="]=e.opt.unpack(C),b.to.next(o)})});return}var j=function(O){_.on("in",{"@":A,err:o.err=O})};if((o._||"").DBG&&((o._||"").DBG.c=+new Date),0<=l.indexOf("<?")&&(S=parseFloat(l.split("<?")[1]||""),S&&w<d.state()-S*1e3)){(S=o._)&&S.stun&&S.stun--;return}if(l==="~@"){p.alias(b,o,y,i,l,_,j);return}if(l.slice(0,2)==="~@"){p.pubs(b,o,y,i,l,_,j);return}if(S=e.opt.pub(l)){p.pub(b,o,y,i,l,_,j,_.user||"",S);return}if(0<=l.indexOf("#")){p.hash(b,o,y,i,l,_,j);return}p.any(b,o,y,i,l,_,j,_.user||"")}}p.hash=function(o,b,_,m,l,i,y){e.work(_,null,function(w){function A(S){let j="";for(let O=0;O<S.length;O++)j+=O-1&1?"":String.fromCharCode(parseInt(S.substring(O-1,O+1),16));return btoa(j)}if(w&&w===m.split("#").slice(-1)[0])return o.to.next(b);if(w&&w===A(m.split("#").slice(-1)[0]))return o.to.next(b);y("Data hash not same as hash!")},{name:"SHA-256"})},p.alias=function(o,b,_,m,l,i,y){if(!_)return y("Data must exist!");if("~@"+m===a(_))return o.to.next(b);y("Alias not same!")},p.pubs=function(o,b,_,m,l,i,y){if(!_)return y("Alias must exist!");if(m===a(_))return o.to.next(b);y("Alias not same!")},p.pub=async function(o,b,_,m,l,i,y,w,A){var S;const j=await r.parse(_)||{},O=(C,$,x)=>{if(C.m&&C.s&&$&&A)return e.verify(C,A,h=>{if(s!==h&&s!==h.e&&b.put[">"]&&b.put[">"]>parseFloat(h.e))return y("Certificate expired.");if(s!==h&&h.c&&h.w&&(h.c===$||h.c.indexOf("*")>-1)){let E=l.indexOf("/")>-1?l.replace(l.substring(0,l.indexOf("/")+1),""):"";String.match=String.match||d.text.match;const B=Array.isArray(h.w)?h.w:typeof h.w=="object"||typeof h.w=="string"?[h.w]:[];for(const N of B)if(String.match(E,N["#"])&&String.match(m,N["."])||!N["."]&&String.match(E,N["#"])||!N["#"]&&String.match(m,N["."])||String.match(E?E+"/"+m:m,N["#"]||N)){if(N["+"]&&N["+"].indexOf("*")>-1&&E&&E.indexOf($)==-1&&m.indexOf($)==-1)return y(`Path "${E}" or key "${m}" must contain string "${$}".`);if(h.wb&&(typeof h.wb=="string"||(h.wb||{})["#"])){var T=o.as.root.$.back(-1);return typeof h.wb=="string"&&h.wb.slice(0,1)!=="~"&&(T=T.get("~"+A)),T.get(h.wb).get($).once(D=>D&&(D===1||D===!0)?y(`Certificant ${$} blocked.`):x(h))}return x(h)}return y("Certificate verification fail.")}})};if(m==="pub"&&"~"+A===l)return _===A?o.to.next(b):y("Account not same!");if((S=w.is)&&S.pub&&!j["*"]&&!j["+"]&&(A===S.pub||A!==S.pub&&((b._.msg||{}).opt||{}).cert)){e.opt.pack(b.put,C=>{e.sign(C,w._.sea,async function($){if(s===$)return y(e.err||"Signature fail.");if(b.put[":"]={":":S=e.opt.unpack($.m),"~":$.s},b.put["="]=S,A===w.is.pub){(S=a(_))&&((i.sea.own[S]=i.sea.own[S]||{})[A]=1),JSON.stringifyAsync(b.put[":"],function(x,h){return x?y(x||"Stringify error."):(b.put[":"]=h,o.to.next(b))});return}if(A!==w.is.pub&&((b._.msg||{}).opt||{}).cert){const x=await r.parse(b._.msg.opt.cert);x&&x.m&&x.s&&O(x,w.is.pub,h=>{b.put[":"]["+"]=x,b.put[":"]["*"]=w.is.pub,JSON.stringifyAsync(b.put[":"],function(T,E){return T?y(T||"Stringify error."):(b.put[":"]=E,o.to.next(b))})})}},{raw:1})});return}e.opt.pack(b.put,C=>{e.verify(C,j["*"]||A,function($){var x;if($=e.opt.unpack($),s===$)return y("Unverified data.");if((x=a($))&&A===e.opt.pub(x)&&((i.sea.own[x]=i.sea.own[x]||{})[A]=1),j["+"]&&j["+"].m&&j["+"].s&&j["*"])O(j["+"],j["*"],h=>(b.put["="]=$,o.to.next(b)));else return b.put["="]=$,o.to.next(b)})})},p.any=function(o,b,_,m,l,i,y,w){if(i.opt.secure)return y("Soul missing public key at '"+m+"'.");i.on("secure",function(A){if(this.off(),!i.opt.secure)return o.to.next(A);y("Data cannot be changed.")}).on.on("secure",b)};var u=d.valid,a=function(o,b){return typeof(b=u(o))=="string"&&b};(d.state||"").ify;var f=/[^\w_-]/;e.opt.pub=function(o){if(o&&(o=o.split("~"),!(!o||!(o=o[1]))&&(o=o.split(f).slice(0,2),!(!o||o.length!=2)&&(o[0]||"")[0]!=="@")))return o=o.slice(0,2).join("."),o},e.opt.stringy=function(o){},e.opt.pack=function(o,b,_,m,l){var i,y;if(e.opt.check(o))return b(o);o&&o["#"]&&o["."]&&o[">"]&&(i=o[":"],y=1),JSON.parseAsync(y?i:o,function(w,A){var S=s!==(A||"")[":"]&&(A||"")["~"];if(!S){b(o);return}b({m:{"#":l||o["#"],".":_||o["."],":":(A||"")[":"],">":o[">"]||d.state.is(m,_)},s:S})})};var v=e.opt;e.opt.unpack=function(o,b,_){var m;if(s!==o){if(o&&s!==(m=o[":"]))return m;if(b=b||v.fall_key,!_&&v.fall_val&&(_={},_[b]=v.fall_val),!(!b||!_)){if(o===_[b]||!e.opt.check(_[b]))return o;var l=_&&_._&&_._["#"]||v.fall_soul,i=d.state.is(_,b)||v.fall_state;if(o&&o.length===4&&l===o[0]&&b===o[1]&&k(i)===k(o[3]))return o[2];if(i<e.opt.shuffle_attack)return o}}},e.opt.shuffle_attack=15463296e5;var k=Math.floor})(t,"./index")})()}(ne)),ne.exports}var gi=_i();const ln=Ke(gi);var xe={exports:{}},cn={},pn;function bi(){if(pn)return cn;pn=1;var n={},t=typeof window<"u"?window.Gun:He(),c;t.on("opt",function(e){g(e),this.to.next(e)});function g(e){if(e.axe)return;var r=e.opt;if(r.peers,r.axe===!1||typeof process<"u"&&""+(n||"").AXE=="false")return;t.log.once("AXE","AXE relay enabled!");var s=e.axe={},d=r.mesh=r.mesh||t.Mesh(e),p=e.dup;d.way=function(_){if(_){if(_.get)return u(_);_.put||a(_)}};function u(_){if(_){var m=(_._||"").via,l;if(!m||!m.id||!(l=f(_)._))return a(_);l.asked=+new Date,u.turn(_,l.route,0)}}u.turn=function(_,m,l){var i=_["#"],y=p.s[i],w;if(!(!i||!y)&&(clearTimeout(y.lack),!(y.ack&&(i=y["##"])&&_["##"]===i))){if(w=Object.maps(m||r.peers).slice(l=l||0),!w.length){if(!m)return;u.turn(_,c,0);return}setTimeout.each(w,function(A){var S=r.peers[A];if(l++,!S||!S.wire){m&&m.delete(A);return}if(d.say(_,S)!==!1&&l%3==0)return 1},function(){y["##"]=_["##"],y.lack=setTimeout(function(){u.turn(_,m,l)},25)},3)}};function a(_){d.say(_,r.peers)}function f(_){var m="",l,i,y;if(!_||!_.get)return m;typeof(l=_.get["#"])=="string"&&(m=e.$.get(l)),typeof(y=_.get["."])=="string"?i=y:i="";var w=(_._||"").via,A=w.sub||(w.sub=new Object.Map);return(A.get(l)||A.set(l,y=new Object.Map)&&y).set(i,1),w.id&&m._&&(m._.route||(m._.route=new Object.Map)).set(w.id,w),m}function v(_){return(_=_||"")["="]||_["*"]||_[">"]||_}e.on("in",function(_){var m=this.to,l;if((l=_["@"])&&(l=p.s[l])){if(l.ack=(l.ack||0)+1,l.it&&l.it.get&&_.put){var i=l.it.get||"",y=f(l.it)._,w=(l.it._||"").via||"",A;if(w&&y&&(w.id&&(y.route||(y.route=new Object.Map)).set(w.id,w),A=w.sub||(w.sub=new Object.Map),y&&(A.get(v(i["#"]))||A.set(v(i["#"]),A=new Object.Map)&&A).set(v(i["."]),1),w=(_._||"").via||"",w&&(w.id&&(y.route||(y.route=new Object.Map)).set(w.id,w),A=w.sub||(w.sub=new Object.Map),y))){var S=v(i["#"]),j=A.get(S),O=v(i["."]);O?(j||A.set(S,j=new Object.Map)&&j).set(O,1):j||(A.set(S,j=new Object.Map),j.set("",1))}}if(l=l.back){setTimeout.each(Object.keys(l),function(C){m.next({"#":_["#"],"@":C,ok:_.ok})});return}}m.next(_)}),e.on("create",function(_){this.to.next(_),_.on("put",function(m){var l=this;l.as;var i=m.put,y=i["#"],w=i["."],A=i[":"],S=i[">"];if(l.to.next(m),!m["@"]&&!(!y||!w)){var j=_.$.get(y)._,O=(j||"").route;if(O){if(j.skip&&j.skip.has==w){j.skip.now=m["#"];return}(j.skip={now:m["#"],has:w}).to=setTimeout(function(){setTimeout.each(Object.maps(O),function(C){var $,B,x=j.skip||"";if(j.skip=null,!!($=O.get(C))){if(!$.wire){O.delete(C);return}var h=($.sub||($.sub=new Object.Map)).get(y);if(h&&!(!h.get(w)&&!h.get(""))){var T=$.put||($.put={}),E=_.graph[y],B;E&&c!==(B=E[w])&&(S=b(E,w),A=B),T[y]=o(T[y],w,S,A,y),B=p.track($.next=$.next||String.random(9)),(B.back||(B.back={}))[""+(x.now||m["#"])]=1,!$.to&&($.to=setTimeout(function(){k($)},r.gap))}}})},9)}}})});function k(_){var m={"#":_.next,put:_.put,ok:{"@":3,"/":d.near}};_.next=_.put=_.to=null,d.say(m,_)}var o=t.state.ify,b=t.state.is;(function(){s.up={};var _=d.hear["?"];d.hear["?"]=function(m,l){var i;if(_(m,l),!!l.pid){if(l.pid===r.pid){d.bye(l);return}if(i=s.up[l.pid]){if(i===l)return;r.pid>l.pid&&(i=l,l=s.up[i.pid]),i.url=i.url||l.url,d.bye(l),s.up[i.pid]=i;return}l.url&&(s.up[l.pid]=l,s.stay&&s.stay())}},d.hear.opt=function(m,l){if(!m.ok){var i=m.opt;i&&(i=i.peers,!(!i||typeof i!="string")&&(99<=Object.keys(s.up).length||(d.hi({id:i,url:i,retry:9}),l&&d.say({dam:"opt",ok:1,"@":m["#"]},l))))}},s.stay=function(){clearTimeout(s.stay.to),s.stay.to=setTimeout(function(m,l){(m=e.stats&&e.stats.stay)&&(l={},Object.keys(s.up||"").forEach(function(i){i=(s.up||"")[i],i.url&&(l[i.url]={})}),(m.axe=m.axe||{}).up=l)},1e3*9)},setTimeout(function(m){(m=e.stats&&e.stats.stay&&e.stats.stay.axe)&&(m=m.up)&&(m instanceof Array||(m=Object.keys(m)),setTimeout.each(m||[],function(l){d.hear.opt({opt:{peers:l}})}))},1e3)})(),function(){r.mob=r.mob||9900,e.on("hi",function(_){if(this.to.next(_),!_.url){var m=d.near;if(!(r.mob>=m)){var l={};Object.keys(s.up).forEach(function(i){i=s.up[i],i.url&&(l[i.url]={})}),d.say({dam:"mob",mob:m,peers:l},_),setTimeout(function(){d.bye(_)},9)}}}),e.on("bye",function(_){this.to.next(_)})}()}return function(){var e=Array.from;if(Object.maps=function(r){return e&&r instanceof Map?e(r.keys()):(r instanceof Object.Map&&(r=r.s),Object.keys(r))},e)return Object.Map=Map;(Object.Map=function(){this.s={}}).prototype={set:function(r,s){return this.s[r]=s,this},get:function(r){return this.s[r]},delete:function(r){delete this.s[r]}}}(),cn}var hn;function mi(){return hn||(hn=1,function(n){(function(){var t=setTimeout||{},c;typeof window!=""+c&&(t.window=window);var g=(t.window||"").AXE||function(){};(g.window=t.window)&&(g.window.AXE=g);var e=(g.window||"").GUN||He();(e.AXE=g).GUN=g.Gun=e,e.window||bi(),e.on("opt",function(s){r(s),this.to.next(s)});function r(s){if(s.axe)return;var d=s.opt,p=d.peers;if(d.axe===!1||!e.window)return;var u=e.window,a=u.localStorage||d.localStorage||{},f=u.location||d.location||{},v=u.navigator||d.navigator||{},k=s.axe={},o,b,_=d.mesh=d.mesh||e.Mesh(s);o=p[b=f.origin+"/gun"]=p[b]||{},o.id=o.url=b,o.retry=o.retry||0,o=p[b="http://localhost:8765/gun"]=p[b]||{},o.id=o.url=b,o.retry=o.retry||0,e.log.once("AXE","AXE enabled: Trying to find network via (1) local peer (2) last used peers (3) a URL parameter, and last (4) hard coded peers."),e.log.once("AXEWarn","Warning: AXE is in alpha, use only for testing!");var m=a.peers||"";m&&(m+=" "),m+=((f.search||"").split("peers=")[1]||"").split("&")[0],s.on("bye",function(i){this.to.next(i),i.url&&(v.onLine||(i.retry=1),!i.retry&&(k.fall&&delete k.fall[i.url||i.id],function y(){if(!k.fall){setTimeout(y,9);return}var w=Object.keys(k.fall||""),A=w[Math.random()*w.length>>0];if(w.length||(a.peers="",A="https://gunjs.herokuapp.com/gun"),p[A]){y();return}_.hi(A)}()))}),s.on("hi",function(i){this.to.next(i),i.url});function l(i){k.fall={},((i||"").match(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/ig)||[]).forEach(function(y){k.fall[y]={url:y,id:y,retry:0}})}if(m){l(m);return}try{fetch(((f.search||"").split("axe=")[1]||"").split("&")[0]||f.axe||"https://raw.githubusercontent.com/wiki/amark/gun/volunteer.dht.md").then(function(i){return i.text()}).then(function(i){l(a.peers=i)}).catch(function(){l()})}catch{l()}}try{""+c!="object"&&(n.exports=g)}catch{}})()}(xe)),xe.exports}mi();const qt=wi(["https://gun-manhattan.herokuapp.com/gun"]),Mt=qt.user().recall({sessionStorage:!0}),Yt=Je(""),vn=Je(!1),Se=Je(null);Mt.get("alias").on(n=>{n&&Yt.set(n)});qt.on("auth",async()=>{try{vn.set(!0);const n=await Mt.get("alias");n?(Yt.set(n),Se.set(null),console.log(`signed in as ${n}`)):(console.warn("Signed in but no alias found"),Se.set("Authentication successful but username missing"))}catch(n){console.error("Auth error:",n),Se.set(n.message)}finally{vn.set(!1)}});function ki(){try{return Mt.leave(),Yt.set(""),sessionStorage.removeItem("pair"),sessionStorage.removeItem("recall"),!0}catch(n){return console.error("Reset auth error:",n),!1}}const dn="fireside.secret.chat";var xi=pt('<div class="error-message svelte-1l0afr"> </div>'),Si=pt('<div class="login-container svelte-1l0afr"><h2 class="svelte-1l0afr">Welcome to Fireside Chat</h2> <p class="subtitle svelte-1l0afr">Secure, encrypted messaging</p> <form class="login-form svelte-1l0afr"><!> <label for="username" class="svelte-1l0afr">Username</label> <input id="username" name="username" minlength="3" maxlength="16" type="text" required class="svelte-1l0afr"> <label for="password" class="svelte-1l0afr">Password</label> <input id="password" name="password" type="password" required class="svelte-1l0afr"> <div class="button-group svelte-1l0afr"><button type="submit" class="login-btn svelte-1l0afr"> </button> <button type="button" class="signup-btn svelte-1l0afr"> </button></div></form></div>');function Qn(n,t){ve(t,!1);let c=et(""),g=et(""),e=et(!1),r=et("");async function s(i){if(i==null||i.preventDefault(),!(!M(c)||!M(g)||M(e))){F(r,""),F(e,!0);try{await new Promise((y,w)=>{Mt.auth(M(c),M(g),({err:A})=>{A?(console.error("Login callback error:",A),w(A)):(console.log("Login callback success (auth initiated)"),y())})})}catch(y){console.error("Login function caught error:",y),F(r,typeof y=="string"?y:y.message||"Login failed. Please check credentials.")}finally{F(e,!1)}}}async function d(i){if(i==null||i.preventDefault(),!(!M(c)||!M(g)||M(e))){F(r,""),F(e,!0);try{await new Promise((y,w)=>{Mt.create(M(c),M(g),({err:A})=>{A?(console.error("Signup callback error:",A),w(A)):(console.log("Signup callback success (user created)"),y())})}),F(e,!1),await s()}catch(y){console.error("Signup function caught error:",y),F(r,typeof y=="string"?y:y.message||"Signup failed. Username might be taken or invalid.")}finally{F(e,!1)}}}qe();var p=Si(),u=Y(z(p),4),a=z(u);{var f=i=>{var y=xi(),w=z(y);It(()=>bt(w,M(r))),ft(i,y)};At(a,i=>{M(r)&&i(f)})}var v=Y(a,4),k=Y(v,4),o=Y(k,2),b=z(o),_=z(b),m=Y(b,2),l=z(m);It(()=>{v.disabled=M(e),k.disabled=M(e),b.disabled=M(e)||!M(c)||!M(g),bt(_,M(e)?"Logging in...":"Login"),m.disabled=M(e)||!M(c)||!M(g),bt(l,M(e)?"Working...":"Sign Up")}),Ne(v,()=>M(c),i=>F(c,i)),Ne(k,()=>M(g),i=>F(g,i)),St("click",m,d),St("submit",u,Wn(s)),ft(n,p),de()}var Ae,yn;function Ai(){if(yn)return Ae;yn=1;var n="Expected a function",t=NaN,c="[object Symbol]",g=/^\s+|\s+$/g,e=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,s=/^0o[0-7]+$/i,d=parseInt,p=typeof Tt=="object"&&Tt&&Tt.Object===Object&&Tt,u=typeof self=="object"&&self&&self.Object===Object&&self,a=p||u||Function("return this")(),f=Object.prototype,v=f.toString,k=Math.max,o=Math.min,b=function(){return a.Date.now()};function _(w,A,S){var j,O,C,$,x,h,T=0,E=!1,B=!1,N=!0;if(typeof w!="function")throw new TypeError(n);A=y(A)||0,m(S)&&(E=!!S.leading,B="maxWait"in S,C=B?k(y(S.maxWait)||0,A):C,N="trailing"in S?!!S.trailing:N);function D(J){var V=j,it=O;return j=O=void 0,T=J,$=w.apply(it,V),$}function G(J){return T=J,x=setTimeout(R,A),E?D(J):$}function I(J){var V=J-h,it=J-T,xt=A-V;return B?o(xt,C-it):xt}function U(J){var V=J-h,it=J-T;return h===void 0||V>=A||V<0||B&&it>=C}function R(){var J=b();if(U(J))return P(J);x=setTimeout(R,I(J))}function P(J){return x=void 0,N&&j?D(J):(j=O=void 0,$)}function L(){x!==void 0&&clearTimeout(x),T=0,j=h=O=x=void 0}function H(){return x===void 0?$:P(b())}function X(){var J=b(),V=U(J);if(j=arguments,O=this,h=J,V){if(x===void 0)return G(h);if(B)return x=setTimeout(R,A),D(h)}return x===void 0&&(x=setTimeout(R,A)),$}return X.cancel=L,X.flush=H,X}function m(w){var A=typeof w;return!!w&&(A=="object"||A=="function")}function l(w){return!!w&&typeof w=="object"}function i(w){return typeof w=="symbol"||l(w)&&v.call(w)==c}function y(w){if(typeof w=="number")return w;if(i(w))return t;if(m(w)){var A=typeof w.valueOf=="function"?w.valueOf():w;w=m(A)?A+"":A}if(typeof w!="string")return w===0?w:+w;w=w.replace(g,"");var S=r.test(w);return S||s.test(w)?d(w.slice(2),S?2:8):e.test(w)?t:+w}return Ae=_,Ae}var Ti=Ai();const wn=Ke(Ti);var ji=pt('<div class="error-message svelte-we0mav"> </div>'),Ei=pt('<div class="empty-state svelte-we0mav"><p>No messages yet. Be the first to say hello!</p></div>'),Oi=pt('<div><div class="message-bubble svelte-we0mav"><div class="message-header svelte-we0mav"><span class="sender"> </span> <span class="timestamp"> </span></div> <p class="message-text svelte-we0mav"> </p></div></div>'),Di=pt('<div class="scroll-button svelte-we0mav"><button class="new-messages svelte-we0mav">↓ New messages</button></div>'),$i=pt('<div class="messages-wrapper svelte-we0mav"><!> <!> <!> <div class="scroll-anchor svelte-we0mav"></div></div> <div class="message-input-container svelte-we0mav"><form class="svelte-we0mav"><textarea placeholder="Type a message..." rows="1" class="svelte-we0mav"></textarea> <button type="submit" class="svelte-we0mav"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg></button></form></div> <!>',1),Ni=pt('<div class="chat-container svelte-we0mav"><!></div>');function Ci(n,t){ve(t,!1);const[c,g]=Xn(),e=()=>Vn(Yt,"$username",c),r=et();let s=et(""),d=et([]),p=et(),u=et(),a,f=et(!0),v=et(!1),k=et(null);function o(){setTimeout(()=>{var j;return(j=M(u))==null?void 0:j.scrollIntoView({behavior:"auto"})},50),F(v,!1)}function b(j){F(f,(j.target.scrollTop||1/0)>a),a=j.target.scrollTop}function _(){if(!M(p)){var j={".":{">":new Date(+new Date-1*1e3*60*60*3).toISOString()},"-":1};F(p,qt.get("fireside").map(j).on(async(O,C)=>{if(O)try{const $=dn,x=await qt.user(O).get("alias")||"Unknown";let h="";try{h=await ln.decrypt(O.what,$)+""}catch(E){console.error("Decryption error:",E),h="[Encrypted message]"}const T=O._.put||Date.now();if(h){const E=T+"-"+Math.random().toString(36).substring(2,9);M(d).some(N=>N.who===x&&N.what===h&&Math.abs(N.when-T)<1e3)||(F(d,[...M(d).slice(-100),{who:x,what:h,when:T,id:E}].sort((N,D)=>N.when-D.when)),M(f)?o():F(v,!0))}}catch($){console.error("Message processing error:",$),F(k,$.message)}}))}}Yn(()=>{e()&&_()}),pi(()=>{M(p)&&M(p).off()});async function m(){if(!(!M(s)||!e()))try{const j=await ln.encrypt(M(s),dn),O=Mt.get("all").set({what:j}),C=new Date().toISOString();qt.get("fireside").get(C).put(O),F(s,""),F(f,!0),o()}catch(j){console.error("Send message error:",j),F(k,"Failed to send message: "+j.message)}}function l(j){j.key==="Enter"&&!j.shiftKey&&(j.preventDefault(),m())}function i(j){return new Date(j).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}Ze(()=>wn,()=>{F(r,wn(b,1e3))}),Ze(()=>(e(),M(p)),()=>{e()?_():M(p)&&(M(p).off(),F(p,null))}),$r(),qe();var y=Ni(),w=z(y);{var A=j=>{var O=$i(),C=Nn(O),$=z(C);{var x=P=>{var L=ji(),H=z(L);It(()=>bt(H,M(k))),ft(P,L)};At($,P=>{M(k)&&P(x)})}var h=Y($,2);{var T=P=>{var L=Ei();ft(P,L)};At(h,P=>{M(d).length===0&&P(T)})}var E=Y(h,2);ii(E,1,()=>M(d),ni,(P,L)=>{var H=Oi(),X=z(H),J=z(X),V=z(J),it=z(V),xt=Y(V,2),ht=z(xt),Dt=Y(J,2),Zt=z(Dt);It(tr=>{si(H,1,`message-container ${(M(L).who===e()?"self":"other")??""}`,"svelte-we0mav"),bt(it,M(L).who),bt(ht,tr),bt(Zt,M(L).what)},[()=>i(M(L).when)],Ee),ft(P,H)});var B=Y(E,2);li(B,P=>F(u,P),()=>M(u));var N=Y(C,2),D=z(N),G=z(D),I=Y(G,2),U=Y(N,2);{var R=P=>{var L=Di(),H=z(L);St("click",H,o),ft(P,L)};At(U,P=>{!M(f)&&M(v)&&P(R)})}It(P=>I.disabled=P,[()=>!M(s).trim()],Ee),St("scroll",C,function(...P){var L;(L=M(r))==null||L.apply(this,P)}),Ne(G,()=>M(s),P=>F(s,P)),St("keydown",G,l),St("submit",D,Wn(m)),ft(j,O)},S=j=>{Qn(j,{})};At(w,j=>{e()?j(A):j(S,!1)})}ft(n,y),de(),g()}var Bi=pt('<div class="user-info svelte-1o7wzzv">Logged in as: <span class="username svelte-1o7wzzv"> </span></div> <button class="signout-btn svelte-1o7wzzv">Sign Out</button>',1),Gi=pt('<main class="svelte-1o7wzzv"><header class="svelte-1o7wzzv"><h1 class="svelte-1o7wzzv">Fireside Chat</h1> <div class="header-actions svelte-1o7wzzv"><!></div></header> <div class="app-container svelte-1o7wzzv"><!></div></main>');function Ii(n,t){ve(t,!1);const[c,g]=Xn(),e=()=>Vn(Yt,"$username",c);function r(){ki()}qe();var s=Gi(),d=z(s),p=Y(z(d),2),u=z(p);{var a=b=>{var _=Bi(),m=Nn(_),l=Y(z(m)),i=z(l),y=Y(m,2);It(()=>bt(i,e())),St("click",y,r),ft(b,_)};At(u,b=>{e()&&b(a)})}var f=Y(d,2),v=z(f);{var k=b=>{Ci(b,{})},o=b=>{Qn(b,{})};At(v,b=>{e()?b(k):b(o,!1)})}ft(n,s),de(),g()}Qr(Ii,{target:document.getElementById("app")});
